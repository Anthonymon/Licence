<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.4">
<meta name="author" content="Stéphane Lopes">
<title>Programmation orientée-objet - Langage Java</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Programmation orientée-objet - Langage Java</h1>
<div class="details">
<span id="author" class="author">Stéphane Lopes</span><br>
<span id="email" class="email"><a href="mailto:stephane.lopes@uvsq.fr">stephane.lopes@uvsq.fr</a></span><br>
<span id="revnumber">version 2016-2017</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Sommaire</div>
<ul class="sectlevel1">
<li><a href="#_gestion_d_erreurs_et_exceptions">1. Gestion d&#8217;erreurs et exceptions</a>
<ul class="sectlevel2">
<li><a href="#_les_erreurs_en_programmation">1.1. Les erreurs en programmation</a></li>
<li><a href="#_gestion_d_erreurs">1.2. Gestion d&#8217;erreurs</a></li>
<li><a href="#_exceptions">1.3. Exceptions</a></li>
<li><a href="#_exceptions_en_java">1.4. Exceptions en Java</a></li>
<li><a href="#_exercices">1.5. Exercices</a></li>
</ul>
</li>
<li><a href="#_entrées_sorties_et_persistance">2. Entrées/sorties et persistance</a>
<ul class="sectlevel2">
<li><a href="#_entrées_sorties_flux_et_persistance">2.1. Entrées/sorties, flux et persistance</a></li>
<li><a href="#_i_o_en_java">2.2. I/O en Java</a></li>
<li><a href="#_utilisation_des_flux">2.3. Utilisation des flux</a></li>
<li><a href="#_sérialisation_en_java">2.4. Sérialisation en Java</a></li>
<li><a href="#_exercices_2">2.5. Exercices</a></li>
</ul>
</li>
<li><a href="#_gestion_des_collections">3. Gestion des collections</a>
<ul class="sectlevel2">
<li><a href="#_introduction">3.1. Introduction</a></li>
<li><a href="#_interfaces">3.2. Interfaces</a></li>
<li><a href="#_implémentations">3.3. Implémentations</a></li>
<li><a href="#_algorithmes">3.4. Algorithmes</a></li>
<li><a href="#_mise_en_uvre">3.5. Mise en &oelig;uvre</a></li>
<li><a href="#_exercices_3">3.6. Exercices</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_gestion_d_erreurs_et_exceptions"><a class="anchor" href="#_gestion_d_erreurs_et_exceptions"></a>1. Gestion d&#8217;erreurs et exceptions</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_les_erreurs_en_programmation"><a class="anchor" href="#_les_erreurs_en_programmation"></a>1.1. Les erreurs en programmation</h3>
<div class="sect3">
<h4 id="_les_erreurs_sont_communes"><a class="anchor" href="#_les_erreurs_sont_communes"></a>1.1.1. Les erreurs sont communes</h4>
<div class="paragraph">
<p>Des erreurs se produisent lors de l&#8217;exécution d&#8217;un programme</p>
</div>
<div class="ulist">
<div class="title">Différents types d&#8217;erreurs</div>
<ul>
<li>
<p>Erreurs de syntaxe</p>
<div class="ulist">
<ul>
<li>
<p>détectées par le compilateur</p>
</li>
</ul>
</div>
</li>
<li>
<p>Erreurs d&#8217;exécution</p>
<div class="ulist">
<ul>
<li>
<p>générées par l&#8217;environnement (plus de mémoire disponible, division par zéro, &#8230;&#8203;)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Erreurs de logique (<em>bogues</em>)</p>
<div class="ulist">
<ul>
<li>
<p>liées à une erreur du développeur</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_plusieurs_questions_à_se_poser"><a class="anchor" href="#_plusieurs_questions_à_se_poser"></a>1.1.2. Plusieurs questions à se poser</h4>
<div class="ulist">
<ul>
<li>
<p>Que considère-t&#8217;on comme une erreur ?</p>
</li>
<li>
<p>Quelle est la gravité de l&#8217;erreur ?</p>
</li>
<li>
<p>Comment détecter l&#8217;erreur ?</p>
</li>
<li>
<p>Comment propager l&#8217;information sur l&#8217;erreur ?</p>
</li>
<li>
<p>Comment et où gérer l&#8217;erreur ?</p>
</li>
<li>
<p>Comment signaler l&#8217;erreur ?</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_qu_est_ce_qu_une_erreur"><a class="anchor" href="#_qu_est_ce_qu_une_erreur"></a>1.1.3. Qu&#8217;est-ce qu&#8217;une erreur ?</h4>
<div class="ulist">
<ul>
<li>
<p>Un événement dans une fonction <em>f</em> est une erreur dans l&#8217;un des cas suivants :</p>
<div class="ulist">
<ul>
<li>
<p>il viole une des préconditions de <em>f</em>,</p>
<div class="ulist">
<ul>
<li>
<p>peut être considéré comme une erreur de programmation &#8658; utilisation des assertions</p>
</li>
</ul>
</div>
</li>
<li>
<p>il empêche <em>f</em> de remplir une des préconditions de ses appelés,</p>
</li>
<li>
<p>il empêche de réaliser une postcondition de <em>f</em>,</p>
</li>
<li>
<p>il empêche <em>f</em> de rétablir un invariant dont elle a la responsabilité.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Les autres événements ne doivent pas être considérés comme des erreurs
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_gestion_d_erreurs"><a class="anchor" href="#_gestion_d_erreurs"></a>1.2. Gestion d&#8217;erreurs</h3>
<div class="sect3">
<h4 id="_erreur_vs_bogue"><a class="anchor" href="#_erreur_vs_bogue"></a>1.2.1. Erreur vs. bogue</h4>
<div class="ulist">
<ul>
<li>
<p>La <em>gestion d&#8217;erreurs</em> est chargée des erreurs d&#8217;exécution</p>
</li>
<li>
<p>Les erreurs de logique (bogues) doivent être éliminées durant le développement en utilisant :</p>
<div class="ulist">
<ul>
<li>
<p>les <em>assertions</em></p>
</li>
<li>
<p>le <em>débogage</em></p>
</li>
<li>
<p>les <em>tests</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_réaction_à_une_erreur"><a class="anchor" href="#_réaction_à_une_erreur"></a>1.2.2. Réaction à une erreur</h4>
<div class="ulist">
<ul>
<li>
<p>Ignorer le problème</p>
<div class="ulist">
<ul>
<li>
<p>en général, c&#8217;est une mauvaise idée&#8230;&#8203;</p>
</li>
</ul>
</div>
</li>
<li>
<p>Retourner un code d&#8217;erreur</p>
<div class="ulist">
<ul>
<li>
<p>possible si une valeur de retour est disponible pour cela</p>
</li>
</ul>
</div>
</li>
<li>
<p>Utiliser une variable globale</p>
<div class="ulist">
<ul>
<li>
<p>son état doit être consulté</p>
</li>
</ul>
</div>
</li>
<li>
<p>Lancer une exception</p>
<div class="ulist">
<ul>
<li>
<p>propage l&#8217;erreur selon la pile d&#8217;appel du programme</p>
</li>
</ul>
</div>
</li>
<li>
<p>Utiliser le <em>type `Option`</em></p>
<div class="ulist">
<ul>
<li>
<p>technique issue de la programmation fonctionnelle</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_retourner_un_code_d_erreur"><a class="anchor" href="#_retourner_un_code_d_erreur"></a>1.2.3. Retourner un code d&#8217;erreur</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">    public static double sqrtWithReturnCode(double d) {
        return Double.isNaN(d) || d &lt; 0.0 ?
                Double.NaN :
                sqrt(d);
    }</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">            double result = sqrtWithReturnCode(value);
            if (Double.isNaN(result)) {
                System.err.println("Argument illégal (négatif ou égal à NaN).");
            } else {
                System.out.printf("sqrt(%f) = %f\n", value, result);
            }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_utiliser_une_variable_globale"><a class="anchor" href="#_utiliser_une_variable_globale"></a>1.2.4. Utiliser une variable globale</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">    public static enum SqrtError { None, NegArg, NaNArg; }
    private static SqrtError sqrtError = SqrtError.None;
    public static SqrtError getSqrtError() { return sqrtError; }
    public static double sqrtWithGlobalCode(double d) {
        if (Double.isNaN(d)) {
            sqrtError = SqrtError.NaNArg;
        } else if (d &lt; 0) {
            sqrtError = SqrtError.NegArg;
        }
        return sqrt(d);
    }</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">            double result = sqrtWithGlobalCode(value);
            if (getSqrtError() != SqrtError.None) {
                System.err.println("Argument illégal (négatif ou égal à NaN).");
            } else {
                System.out.printf("sqrt(%f) = %f\n", value, result);
            }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_lancer_une_exception"><a class="anchor" href="#_lancer_une_exception"></a>1.2.5. Lancer une exception</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">    public static double sqrtWithException(double d) {
        if (Double.isNaN(d) || d &lt; 0.0) {
            throw new IllegalArgumentException("Argument négatif ou NaN");
        }
        return sqrt(d);
    }</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">            double result;
            try {
                result = sqrtWithException(value);
                System.out.printf("sqrt(%f) = %f\n", value, result);
            } catch (IllegalArgumentException ex) {
                ex.printStackTrace(System.err);
            }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_utiliser_le_type_code_option_code"><a class="anchor" href="#_utiliser_le_type_code_option_code"></a>1.2.6. Utiliser le type <code>Option</code></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">    public static Optional&lt;Double&gt; sqrtWithOption(double d) {
        return Double.isNaN(d) || d &lt; 0.0 ?
                Optional.empty() :
                Optional.of(sqrt(d));
    }</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">            Optional&lt;Double&gt; result = sqrtWithOption(value);
            System.out.printf("sqrt(%f) = %f\n", value, result.orElse(Double.NaN));</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exceptions"><a class="anchor" href="#_exceptions"></a>1.3. Exceptions</h3>
<div class="sect3">
<h4 id="_définition"><a class="anchor" href="#_définition"></a>1.3.1. Définition</h4>
<div class="ulist">
<ul>
<li>
<p>Le terme <em>exception</em> est un raccourci pour <em>événement exceptionnel</em></p>
</li>
<li>
<p>Une <em>exception</em> est un événement se produisant lors de l&#8217;exécution d&#8217;un programme et qui bouleverse le flôt normal d&#8217;instructions</p>
</li>
<li>
<p>Le mécanisme des exceptions est destiné à gérer les erreurs ou les cas exceptionnels (une partie du système n&#8217;a pas pu réaliser ce qui lui était demandé)</p>
<div class="ulist">
<ul>
<li>
<p>"Exceptionnel" ne signifie pas "qui ne se produit presque jamais" ou "désastreux"</p>
</li>
</ul>
</div>
</li>
<li>
<p>Différents types d&#8217;erreurs peuvent générer des exceptions</p>
</li>
<li>
<p>Une exception contient des informations sur l&#8217;erreur qui l&#8217;a produite</p>
</li>
<li>
<p>Les exceptions peuvent être regroupées et organisées en hiérarchie</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_fonctionnement"><a class="anchor" href="#_fonctionnement"></a>1.3.2. Fonctionnement</h4>
<div class="ulist">
<ul>
<li>
<p>L&#8217;action de générer une exception s&#8217;appelle <em>lancer</em> (<em>throw</em>) ou <em>lever</em> (<em>raise</em>) une exception</p>
</li>
<li>
<p>Le système d&#8217;exécution doit alors trouver une portion de code sachant <em>gérer</em> (<em>handle</em>) ou <em>capturer</em> (<em>catch</em>) cette exception</p>
</li>
<li>
<p>Les candidats pour la gestion de l&#8217;exception sont les méthodes de la pile d&#8217;appel</p>
</li>
<li>
<p>Le système d&#8217;exécution remonte la pile d&#8217;appel jusqu&#8217;à trouver un <em>gestionnaire d&#8217;exception</em> (<em>exception handler</em>) approprié</p>
</li>
<li>
<p>Chaque gestionnaire d&#8217;exception gère un type d&#8217;exception particulier</p>
</li>
<li>
<p>Le gestionnaire d&#8217;exception choisi par le système traite l&#8217;exception</p>
</li>
<li>
<p>Si aucun gestionnaire approprié n&#8217;est trouvé, le système stoppe le programme</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_remarques"><a class="anchor" href="#_remarques"></a>1.3.3. Remarques</h4>
<div class="ulist">
<ul>
<li>
<p>Une exception peut être <em>redéclenchée</em></p>
</li>
<li>
<p>un gestionnaire d&#8217;exceptions peut faire un traitement partiel puis "passer la main"</p>
</li>
<li>
<p>L&#8217;ordre des gestionnaires est important</p>
<div class="ulist">
<ul>
<li>
<p>toujours du plus spécialisé au plus général</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_avantages_des_exceptions"><a class="anchor" href="#_avantages_des_exceptions"></a>1.3.4. Avantages des exceptions</h4>
<div class="ulist">
<ul>
<li>
<p>Séparation du code de gestion d&#8217;erreurs et du code "normal"</p>
<div class="ulist">
<ul>
<li>
<p>évite les "empilements" d&#8217;instructions conditionnelles</p>
</li>
<li>
<p>améliore la lisibilité du code</p>
</li>
</ul>
</div>
</li>
<li>
<p>Propagation des erreurs en suivant la pile d&#8217;appels de méthodes</p>
<div class="ulist">
<ul>
<li>
<p>simplification de la propagation</p>
</li>
<li>
<p>les méthodes que l&#8217;erreur ne concerne pas n&#8217;en tiennent pas compte</p>
</li>
</ul>
</div>
</li>
<li>
<p>Regroupement des types d&#8217;erreurs</p>
<div class="ulist">
<ul>
<li>
<p>possibilité de gérer ensemble des exceptions de même type</p>
</li>
<li>
<p>par exemple, exceptions concernant un tableau ou un fichier</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<strong>La gestion d&#8217;erreurs reste une tâche difficile !</strong>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_inconvénients_des_exceptions"><a class="anchor" href="#_inconvénients_des_exceptions"></a>1.3.5. Inconvénients des exceptions</h4>
<div class="ulist">
<ul>
<li>
<p>Moins structurées qu&#8217;une gestion locale</p>
<div class="ulist">
<ul>
<li>
<p>revers de la séparation code de gestion d&#8217;erreurs/code normal</p>
</li>
</ul>
</div>
</li>
<li>
<p>Moins efficace</p>
<div class="ulist">
<ul>
<li>
<p>le mécanisme de propagation a un coût</p>
</li>
</ul>
</div>
</li>
<li>
<p>Peut rendre certaines situations complexes</p>
</li>
</ul>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<strong>Le mécanisme des exceptions offre une alternative aux techniques traditionnelles lorsque celles-ci se révèlent insuffisantes, peu élégantes et susceptibles d&#8217;introduire des erreurs</strong>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exceptions_en_java"><a class="anchor" href="#_exceptions_en_java"></a>1.4. Exceptions en Java</h3>
<div class="sect3">
<h4 id="_généralités"><a class="anchor" href="#_généralités"></a>1.4.1. Généralités</h4>
<div class="ulist">
<ul>
<li>
<p>Trois catégories d&#8217;exceptions</p>
<div class="ulist">
<ul>
<li>
<p>une <em>exception non contrôlée</em> (<em>unchecked exceptions</em>) n&#8217;est pas destinée à être traitée par le
programme</p>
<div class="ulist">
<ul>
<li>
<p>une <em>erreur</em> (<em>error</em>) a une cause externe à l&#8217;application</p>
</li>
<li>
<p>une <em>exception d&#8217;exécution</em> (<em>runtime exception</em>) est provoquée par la JVM</p>
</li>
</ul>
</div>
</li>
<li>
<p>une <em>exception contrôlée</em> (<em>checked exception</em>) est une exception qui n&#8217;est pas lancée par le système d&#8217;exécution Java (<em>runtime exception</em>)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Une exception est une instance d&#8217;une classe dérivée de <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Throwable.html"><code>Throwable</code></a></p>
</li>
<li>
<p>Une méthode doit soit <em>traiter</em>, soit <em>spécifier</em> toute <em>exception contrôlée</em> qui peut se produire dans cette méthode</p>
<div class="ulist">
<ul>
<li>
<p><em>traiter</em> = fournir un gestionnaire d&#8217;exception pour ce type d&#8217;exception</p>
</li>
<li>
<p><em>spécifier</em> = préciser dans sa signature qu&#8217;elle peut la lancer</p>
</li>
</ul>
</div>
</li>
<li>
<p>Le compilateur ne requiert pas que les exceptions du système d&#8217;exécution soient traitée ou spécifiée</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_le_traitement_d_une_exception_comprend"><a class="anchor" href="#_le_traitement_d_une_exception_comprend"></a>1.4.2. Le traitement d&#8217;une exception comprend</h4>
<div class="ulist">
<ul>
<li>
<p>Un bloc <code>try</code></p>
<div class="ulist">
<ul>
<li>
<p>autour de la séquence d&#8217;instructions susceptible de lancer une exception</p>
</li>
</ul>
</div>
</li>
<li>
<p>Un ou plusieurs blocs <code>catch</code></p>
<div class="ulist">
<ul>
<li>
<p>représentant les gestionnaires d&#8217;exceptions</p>
</li>
</ul>
</div>
</li>
<li>
<p>Au plus un bloc <code>finally</code></p>
<div class="ulist">
<ul>
<li>
<p>toujours exécuté</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_le_bloc_code_try_code"><a class="anchor" href="#_le_bloc_code_try_code"></a>1.4.3. Le bloc <code>try</code></h4>
<div class="ulist">
<ul>
<li>
<p>Le bloc <code>try</code> englobe les instructions susceptibles de lancer une exception</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">try {
    // Instructions
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>L&#8217;instruction <code>try</code> <em>gouverne</em> les instructions englobées</p>
</li>
<li>
<p>Il définit la portée des gestionnaires d&#8217;exceptions qui lui sont associés</p>
</li>
<li>
<p>Une instruction <code>try</code> <strong>doit</strong> être accompagnée d&#8217;au moins un bloc <code>catch</code> ou <code>finally</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_les_blocs_code_catch_code"><a class="anchor" href="#_les_blocs_code_catch_code"></a>1.4.4. Les blocs <code>catch</code></h4>
<div class="ulist">
<ul>
<li>
<p>Les blocs <code>catch</code> représentent les gestionnaires d&#8217;exceptions</p>
</li>
<li>
<p>Un ou plusieurs blocs <code>catch</code> sont placés immédiatement après un bloc <code>try</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">try {
    // Instructions
} catch ( /* ... */ ) {
    // Instructions
} catch ( /* ... */ ) {
    // Instructions
} // ...</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Les blocs <code>catch</code> doivent être ordonnés du plus spécialisé au plus général</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_détail_d_un_bloc_code_catch_code"><a class="anchor" href="#_détail_d_un_bloc_code_catch_code"></a>1.4.5. Détail d&#8217;un bloc <code>catch</code></h4>
<div class="ulist">
<ul>
<li>
<p>L&#8217;instruction <code>catch</code> requiert un unique paramètre</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">catch (&lt;Type&gt; &lt;variable&gt;) {
    // Instructions
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>&lt;Type&gt;</code> représente le type de l&#8217;exception et doit être une classe dérivant de <code>Throwable</code></p>
</li>
<li>
<p><code>&lt;variable&gt;</code> est le nom de la variable liée à l&#8217;exception (locale au gestionnaire)</p>
</li>
<li>
<p>L&#8217;argument du <code>catch</code> ressemble à la déclaration d&#8217;un paramètre de méthode</p>
</li>
<li>
<p>Un gestionnaire peut capturer plusieurs types d&#8217;exceptions</p>
<div class="ulist">
<ul>
<li>
<p>en capturant une superclasse pour une exception</p>
</li>
<li>
<p>en utilisant plusieurs types dans la clause <code>catch</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">catch (Type1|Type2|Type3 ex) { //...</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_le_bloc_code_finally_code"><a class="anchor" href="#_le_bloc_code_finally_code"></a>1.4.6. Le bloc <code>finally</code></h4>
<div class="ulist">
<ul>
<li>
<p>Le bloc <code>finally</code> founit un mécanisme pour "nettoyer" l&#8217;état du programme</p>
</li>
<li>
<p>Les instructions du bloc <code>finally</code> sont toujours exécutées</p>
</li>
<li>
<p>Le bloc <code>finally</code> se place après les gestionnaires d&#8217;exceptions du bloc <code>try</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">finally {
    // Instructions
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_des_gestionnaires_d_exception_pour_une_pile"><a class="anchor" href="#_des_gestionnaires_d_exception_pour_une_pile"></a>1.4.7. Des gestionnaires d&#8217;exception pour une pile</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">try {
    Pile unePile = new Pile(2);
    unePile.empile("azerty");
    unePile.empile("qsdfgh");
    unePile.empile("wxcvbn");
    assert false : "Jamais atteint";
    String str = (String) unePile.depile();
} catch (PileVideException e) {
    assert e.getMessage().equals("La Pile est vide");
} catch (PileException e) {
    assert e.getMessage().equals("La Pile est pleine");
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_exception_et_allocation_de_ressources"><a class="anchor" href="#_exception_et_allocation_de_ressources"></a>1.4.8. Exception et allocation de ressources</h4>
<div class="ulist">
<ul>
<li>
<p>La construction <em>try-with-resources</em> gère automatiquement la fermeture des ressources</p>
</li>
<li>
<p>Les classes représentant les ressources doivent implémenter l&#8217;interface <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/AutoCloseable.html"><code>AutoCloseable</code></a></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">try (
    java.util.zip.ZipFile zf =
       new java.util.zip.ZipFile(zipFileName);
    java.io.BufferedWriter writer =
       java.nio.file.Files.newBufferedWriter(outputFilePath, charset)
) {
    // ...
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_spécification_d_exceptions"><a class="anchor" href="#_spécification_d_exceptions"></a>1.4.9. Spécification d&#8217;exceptions</h4>
<div class="ulist">
<ul>
<li>
<p>Une <em>spécification d&#8217;exception</em> précise qu&#8217;une méthode ne capture pas l&#8217;exception considérée mais peut la lancer</p>
</li>
<li>
<p>Pour spécifier qu&#8217;une ou plusieurs exceptions peuvent être lancées par une méthode, on utilise la clause <code>throws</code> dans la signature de la méthode</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">TypeRetour nomMethode throws Type1Exception, Type2Exception {
    //...
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_spécification_d_exceptions_pour_la_pile"><a class="anchor" href="#_spécification_d_exceptions_pour_la_pile"></a>1.4.10. Spécification d&#8217;exceptions pour la pile</h4>
<div class="listingblock">
<div class="title"><code>empile</code> peut lancer une exception de type <code>PilePleineException</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">/**
 * Empile un élément au sommet de la pile.
 *
 * @param unObjet l'objet à empiler
 * @throws PilePleineException s'il n'y a plus de place
 */
public void empile(Object unObjet) throws PilePleineException {</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><code>depile</code> peut lancer une exception de type <code>PileVideException</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">/**
 * Dépile l'élément se trouvant au sommet de la pile.
 *
 * @return l'élément au sommet
 * @throws PileVideException s'il n'y a pas d'élément
 */
public Object depile() throws PileVideException {</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_lancement_d_exceptions"><a class="anchor" href="#_lancement_d_exceptions"></a>1.4.11. Lancement d&#8217;exceptions</h4>
<div class="ulist">
<ul>
<li>
<p>L&#8217;instruction <code>throw</code> est utilisée pour lancer une exception</p>
</li>
<li>
<p>Le mot-clé <code>throw</code> doit être suivi d&#8217;une instance d&#8217;une classe dérivée de <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Throwable.html"><code>Throwable</code></a></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">throw new ClasseDerivéeDeThrowable();</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Une exception peut être relancée à partir d&#8217;un bloc <code>catch</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_lancements_d_exceptions_pour_la_pile"><a class="anchor" href="#_lancements_d_exceptions_pour_la_pile"></a>1.4.12. Lancements d&#8217;exceptions pour la pile</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">/**
 * Empile un élément au sommet de la pile.
 *
 * @param unObjet l'objet à empiler
 * @throws PilePleineException s'il n'y a plus de place
 */
public void empile(Object unObjet) throws PilePleineException {
    if (sommet == contenu.length) {
        throw new PilePleineException();
    }
    contenu[sommet++] = unObjet;
}

/**
 * Dépile l'élément se trouvant au sommet de la pile.
 *
 * @return l'élément au sommet
 * @throws PileVideException s'il n'y a pas d'élément
 */
public Object depile() throws PileVideException {
    if (sommet == 0) {
        throw new PileVideException();
    }
    return contenu[--sommet];
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_la_classe_code_throwable_code"><a class="anchor" href="#_la_classe_code_throwable_code"></a>1.4.13. La classe <code>Throwable</code></h4>
<div class="ulist">
<ul>
<li>
<p>La classe <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Throwable.html"><code>Throwable</code></a> est la super-classe de toutes les exceptions ou erreurs du langage Java</p>
</li>
<li>
<p>Seules les instances de cette classe (ou d&#8217;une de ses sous-classe) peuvent être lancées</p>
</li>
<li>
<p>Seule cette classe (ou l&#8217;une de ses sous-classe) peut être l&#8217;argument d&#8217;un <code>catch</code></p>
</li>
<li>
<p>Contient un instantané de la <em>pile d&#8217;exécution</em> au moment de la création de l&#8217;instance</p>
</li>
<li>
<p>Peut contenir une <em>cause</em> (une autre instance de <code>Throwable</code>) afin de gérer une <em>chaîne d&#8217;exceptions</em></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_les_méthodes_de_la_classe_code_throwable_code"><a class="anchor" href="#_les_méthodes_de_la_classe_code_throwable_code"></a>1.4.14. Les méthodes de la classe <code>Throwable</code></h4>
<div class="imageblock">
<div class="content">
<img src="figs/throwable.png" alt="throwable">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_hiérarchie_d_exceptions_de_la_librairie_java"><a class="anchor" href="#_hiérarchie_d_exceptions_de_la_librairie_java"></a>1.4.15. Hiérarchie d&#8217;exceptions de la librairie Java</h4>
<div class="imageblock">
<div class="content">
<img src="figs/throwable_hier.png" alt="throwable hier">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_créer_des_classes_exceptions"><a class="anchor" href="#_créer_des_classes_exceptions"></a>1.4.16. Créer des classes exceptions</h4>
<div class="ulist">
<ul>
<li>
<p>Déterminer dans quelles méthodes et sous quelles conditions des exceptions seront lancées</p>
</li>
<li>
<p>Choisir le type de chaque exception</p>
<div class="ulist">
<ul>
<li>
<p>utiliser une exception existante</p>
</li>
<li>
<p>en créer une nouvelle</p>
</li>
</ul>
</div>
</li>
<li>
<p>Choisir quelle sera la super-classe des exceptions définies</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Exception.html"><code>Exception</code></a> ou l&#8217;une de ses sous-classes</p>
</li>
<li>
<p>Les exceptions dérivée de <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/RuntimeException.html"><code>RuntimeException</code></a> ne sont pas contrôlées</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_la_hiérarchie_d_exceptions_pour_une_pile"><a class="anchor" href="#_la_hiérarchie_d_exceptions_pour_une_pile"></a>1.4.17. La hiérarchie d&#8217;exceptions pour une pile</h4>
<div class="imageblock">
<div class="content">
<img src="figs/pile-exception-hierarchie.png" alt="pile exception hierarchie" width="347" height="283">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_la_classe_code_pileexception_code"><a class="anchor" href="#_la_classe_code_pileexception_code"></a>1.4.18. La classe <code>PileException</code></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">package fr.uvsq.info.poo.errors;

/**
 * La racine de la hiérarchie d'exception pour la pile.
 *
 * @author Stéphane Lopes
 * @version fév. 2017
 */
class PileException extends Exception {
    /**
     * Initialise une instance de &lt;code&gt;PileException&lt;/code&gt;.
     *
     * @param message le message d'erreur.
     */
    public PileException(String message) {
        super(message);
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_la_classe_code_pilevideexception_code"><a class="anchor" href="#_la_classe_code_pilevideexception_code"></a>1.4.19. La classe <code>PileVideException</code></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">package fr.uvsq.info.poo.errors;

/**
 * Exception pour la pile vide.
 *
 * @author Stéphane Lopes
 * @version fév. 2017
 */
class PileVideException extends PileException {
    /**
     * Initialise une instance de &lt;code&gt;PileVideException&lt;/code&gt;.
     */
    public PileVideException() {
        super("La Pile est vide");
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_la_classe_code_pilepleineexception_code"><a class="anchor" href="#_la_classe_code_pilepleineexception_code"></a>1.4.20. La classe <code>PilePleineException</code></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">package fr.uvsq.info.poo.errors;

/**
 * Exception pour la pile pleine.
 *
 * @author Stéphane Lopes
 * @version fév. 2017
 */
class PilePleineException extends PileException {
    /**
     * Initialise une instance de &lt;code&gt;PilePleineException&lt;/code&gt;.
     */
    public PilePleineException() {
        super("La Pile est pleine");
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exercices"><a class="anchor" href="#_exercices"></a>1.5. Exercices</h3>
<div class="sect3">
<h4 id="_calculatrice_rpn"><a class="anchor" href="#_calculatrice_rpn"></a>1.5.1. Calculatrice RPN</h4>
<div class="paragraph">
<p>Dans cette exercice, on souhaite réaliser une calculatrice fonctionnant en mode RPN
(<a href="http://fr.wikipedia.org/wiki/Notation_polonaise_inverse"><em>Reverse Polish Notation</em></a>).
Cette notation post-fixée permet de représenter des formules arithmétiques sans parenthèses.
Par exemple, l&#8217;expression \$2 xx (3 + 4)\$ pourra s&#8217;écrire \$2 3 4 + xx\$.</p>
</div>
<div class="paragraph">
<p>Cette calculatrice devra supporter les opérations de base (<code>+, -, *, /</code>) sur des nombres réels.
L&#8217;intervalle de nombres supporté sera spécifié par deux constantes
(<code>MAX_VALUE</code> pour le plus grand nombre en valeur absolue,
<code>MIN_VALUE</code> pour le plus petit nombre en valeur absolue).
L&#8217;utilisateur saisira au clavier soit un nombre, soit une opération, soit <code>exit</code> pour sortir.
Chaque saisie se terminera par <em>entrée</em>.
Après chaque saisie, le programme affichera l&#8217;expression courante.</p>
</div>
<div class="paragraph">
<p>L&#8217;implémentation pourra utiliser une pile de la façon suivante&#160;:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>les opérandes sont empilées lors de leur saisie,</p>
</li>
<li>
<p>les opérations sont effectuées immédiatement en considérant les opérandes se trouvant au sommet de la pile,</p>
</li>
<li>
<p>le résultat d&#8217;une opération est empilé.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Questions</div>
<ol class="arabic">
<li>
<p>Déterminer les cas d&#8217;erreur.
En déduire les exceptions nécessaires pour la gestion des erreurs de cette application.</p>
</li>
<li>
<p>Organiser ces exceptions en hiérarchie et choisissez une classe de base dans la librairie Java</p>
</li>
<li>
<p>Implémenter l&#8217;énumération <code>Operation</code> de la façon suivante&#160;:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>déclarer l&#8217;attribut <code>symbole</code> représentant le symbole de l&#8217;opération (<code>+</code>, <code>-</code>, &#8230;&#8203;),</p>
</li>
<li>
<p>définir le constructeur prenant en paramètre le symbole de l&#8217;opération,</p>
</li>
<li>
<p>déclarer la méthode abstraite <code>eval</code> retournant le résultat de l&#8217;évaluation de l&#8217;opération sur deux opérandes,</p>
</li>
<li>
<p>définir les constantes <code>PLUS</code>, <code>MOINS</code>, <code>MULT</code> et <code>DIV</code>,</p>
</li>
<li>
<p>pour chacune des constantes, redéfinir la méthode <code>eval</code>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Implémenter la classe <code>MoteurRPN</code> possédant les capacités suivantes&#160;:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>enregistrer une opérandes,</p>
</li>
<li>
<p>appliquer une opération sur les opérandes,</p>
</li>
<li>
<p>retourner l&#8217;ensemble des opérandes stockées.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Implémenter la classe <code>SaisieRPN</code> qui gère les interactions avec l&#8217;utilisateur et invoque le moteur RPN.
La classe <a href="http://docs.oracle.com/javase/8/docs/api/java/util/Scanner.html"><code>java.util.Scanner</code></a> permet de gérer les saisies.</p>
</li>
<li>
<p>Implémenter l&#8217;énumération <code>CalculatriceRPN</code> qui contiendra le programme principal.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_entrées_sorties_et_persistance"><a class="anchor" href="#_entrées_sorties_et_persistance"></a>2. Entrées/sorties et persistance</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_entrées_sorties_flux_et_persistance"><a class="anchor" href="#_entrées_sorties_flux_et_persistance"></a>2.1. Entrées/sorties, flux et persistance</h3>
<div class="sect3">
<h4 id="_entrée_sortie_et_langage_de_programmation"><a class="anchor" href="#_entrée_sortie_et_langage_de_programmation"></a>2.1.1. Entrée/sortie et langage de programmation</h4>
<div class="ulist">
<ul>
<li>
<p>La conception et l&#8217;implémentation d&#8217;une bibliothèque d&#8217;entrée/sortie (I/O) est une tâche difficile</p>
<div class="ulist">
<ul>
<li>
<p>la source ou la destination des données peut varier (mémoire, fichier, réseau, &#8230;&#8203;)</p>
</li>
<li>
<p>les types définis par l&#8217;utilisateur doivent être pris en charge</p>
</li>
</ul>
</div>
</li>
<li>
<p>Le concept de <em>flux</em> est une proposition pour cela</p>
</li>
<li>
<p>La <em>persistance</em> et la <em>sérialisation</em> sont également nécessaires pour les I/O en POO</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_flux"><a class="anchor" href="#_flux"></a>2.1.2. Flux</h4>
<div class="ulist">
<ul>
<li>
<p>Un <em>flux</em> (<em>stream</em>) est un canal reliant une source (ou une destination) à un programme</p>
</li>
<li>
<p>Une source de données (ou une destination) peut être un fichier, la mémoire, le réseau, &#8230;&#8203;</p>
</li>
<li>
<p>Un flux peut être ouvert en lecture et/ou en écriture</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Les données sont lues ou écrites séquentiellement
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_flux_en_lecture"><a class="anchor" href="#_flux_en_lecture"></a>2.1.3. Flux en lecture</h4>
<div class="imageblock">
<div class="content">
<img src="figs/io-ins.png" alt="io ins">
</div>
</div>
<div class="paragraph">
<p>Source : <a href="https://docs.oracle.com/javase/tutorial/essential/io/streams.html">The Java Tutorial</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_flux_en_écriture"><a class="anchor" href="#_flux_en_écriture"></a>2.1.4. Flux en écriture</h4>
<div class="imageblock">
<div class="content">
<img src="figs/io-outs.png" alt="io outs">
</div>
</div>
<div class="paragraph">
<p>Source : <a href="https://docs.oracle.com/javase/tutorial/essential/io/streams.html">The Java Tutorial</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_persistance"><a class="anchor" href="#_persistance"></a>2.1.5. Persistance</h4>
<div class="ulist">
<ul>
<li>
<p>C&#8217;est la capacité de sauvegarder l&#8217;état des objets, i.e. les données finales de l&#8217;application</p>
</li>
<li>
<p>Elle peut être réalisée avec</p>
<div class="ulist">
<ul>
<li>
<p>la bibliothèque d&#8217;I/O du langage,</p>
</li>
<li>
<p>à l&#8217;aide de bibliothèques spécialisées,</p>
</li>
<li>
<p>grâce à un SGBD externe.</p>
</li>
</ul>
</div>
</li>
<li>
<p>La persistance pose un certain nombre de problèmes</p>
<div class="ulist">
<ul>
<li>
<p>sauvegarde de l&#8217;état de l&#8217;objet</p>
</li>
<li>
<p>gestion des types de données</p>
</li>
<li>
<p>gestion des références</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_sérialisation"><a class="anchor" href="#_sérialisation"></a>2.1.6. Sérialisation</h4>
<div class="ulist">
<ul>
<li>
<p>La <em>sérialisation</em> est un processus permettant de transformer un objet en flux d&#8217;octets</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_i_o_en_java"><a class="anchor" href="#_i_o_en_java"></a>2.2. I/O en Java</h3>
<div class="sect3">
<h4 id="_structure_et_fonctionalités"><a class="anchor" href="#_structure_et_fonctionalités"></a>2.2.1. Structure et fonctionalités</h4>
<div class="paragraph">
<p>La bibliothèque standard Java fournit de nombreuses fonctionnalités liées aux E/S</p>
</div>
<div class="ulist">
<ul>
<li>
<p>la gestion des flux (
<a href="https://docs.oracle.com/javase/8/docs/api/java/io/package-summary.html"><code>java.io</code></a>)</p>
</li>
<li>
<p>les fichiers à accés aléatoires (
<a href="https://docs.oracle.com/javase/8/docs/api/java/nio/channels/SeekableByteChannel.html"><code>java.nio.channels.SeekableByteChannel</code></a>,
<a href="https://docs.oracle.com/javase/8/docs/api/java/io/RandomAccessFile.html"><code>RandomAccessFile</code></a>)</p>
</li>
<li>
<p>des fonctionnalités avancées (
<a href="https://docs.oracle.com/javase/8/docs/api/java/nio/package-summary.html"><code>java.nio.channels</code></a>)</p>
</li>
<li>
<p>l&#8217;interaction avec le système de fichiers (
<a href="https://docs.oracle.com/javase/8/docs/api/java/nio/file/package-summary.html"><code>java.nio.file</code></a>,
<a href="https://docs.oracle.com/javase/8/docs/api/java/io/File.html"><code>File</code></a>)</p>
</li>
<li>
<p>l&#8217;entrée et la sortie standard (
<a href="https://docs.oracle.com/javase/8/docs/api/java/io/PrintStream.html"><code>PrintStream</code></a>,
<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Scanner.html"><code>java.util.Scanner</code></a>,
<a href="https://docs.oracle.com/javase/8/docs/api/java/io/Console.html"><code>Console</code></a>)</p>
</li>
<li>
<p>la gestion des archives (
<a href="https://docs.oracle.com/javase/8/docs/api/java/util/zip/package-summary.html"><code>java.util.zip</code></a>,
<a href="https://docs.oracle.com/javase/8/docs/api/java/util/jar/package-summary.html"><code>java.util.jar</code></a>)</p>
</li>
<li>
<p>les fichiers d&#8217;image (
<a href="https://docs.oracle.com/javase/8/docs/api/javax/imageio/package-summary.html"><code>javax.imageio</code></a>)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_gestion_des_flux"><a class="anchor" href="#_gestion_des_flux"></a>2.2.2. Gestion des flux</h4>
<div class="ulist">
<ul>
<li>
<p>La librairie se divise en deux hiérarchies de classes</p>
<div class="ulist">
<ul>
<li>
<p>les flux de caractères (I/O de texte)</p>
</li>
<li>
<p>les flux d&#8217;octets (I/O binaire)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Un flux est automatiquement ouvert lors de sa création</p>
</li>
<li>
<p>La fermeture d&#8217;un flux se fait explicitement avec la méthode <code>close</code></p>
</li>
<li>
<p>La plupart des méthodes peuvent lancer une exception dérivée de
<a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html"><code>IOException</code></a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_flux_de_caractères"><a class="anchor" href="#_flux_de_caractères"></a>2.2.3. Flux de caractères</h4>
<div class="ulist">
<ul>
<li>
<p>Les classes <code>Reader</code> et <code>Writer</code> sont les super-classes abstraites pour les flux de caractères</p>
</li>
<li>
<p>La plate-forme Java manipule des caractères en se basant sur Unicode</p>
</li>
<li>
<p>Les flux de caractères permettent de convertir ce format interne de/vers le format local</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="__code_reader_code_et_code_writer_code"><a class="anchor" href="#__code_reader_code_et_code_writer_code"></a>2.2.4. <code>Reader</code> et <code>Writer</code></h4>
<div class="imageblock">
<div class="content">
<img src="figs/reader_writer.png" alt="reader writer">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_hiérarchie_de_code_reader_code"><a class="anchor" href="#_hiérarchie_de_code_reader_code"></a>2.2.5. Hiérarchie de <code>Reader</code></h4>
<div class="imageblock">
<div class="content">
<img src="figs/reader-hierarchie.png" alt="reader hierarchie" width="958" height="283">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_hiérarchie_de_code_writer_code"><a class="anchor" href="#_hiérarchie_de_code_writer_code"></a>2.2.6. Hiérarchie de <code>Writer</code></h4>
<div class="imageblock">
<div class="content">
<img src="figs/writer-hierarchie.png" alt="writer hierarchie" width="1045" height="283">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_flux_d_octets"><a class="anchor" href="#_flux_d_octets"></a>2.2.7. Flux d&#8217;octets</h4>
<div class="ulist">
<ul>
<li>
<p>Les classes <code>InputStream</code> et <code>OutputStream</code> sont les super-classes abstraites pour les flux d&#8217;octets</p>
</li>
<li>
<p>Les flux d&#8217;octets supportent la lecture et l&#8217;écriture d&#8217;octets (8 bits)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="__code_inputstream_code_et_code_outputstream_code"><a class="anchor" href="#__code_inputstream_code_et_code_outputstream_code"></a>2.2.8. <code>InputStream</code> et <code>OutputStream</code></h4>
<div class="imageblock">
<div class="content">
<img src="figs/input_output.png" alt="input output">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_hiérarchie_de_code_inputstream_code"><a class="anchor" href="#_hiérarchie_de_code_inputstream_code"></a>2.2.9. Hiérarchie de <code>InputStream</code></h4>
<div class="imageblock">
<div class="content">
<img src="figs/inputstream-hierarchie.png" alt="inputstream hierarchie" width="1096" height="283">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_hiérarchie_de_code_outputstream_code"><a class="anchor" href="#_hiérarchie_de_code_outputstream_code"></a>2.2.10. Hiérarchie de <code>OutputStream</code></h4>
<div class="imageblock">
<div class="content">
<img src="figs/outputstream-hierarchie.png" alt="outputstream hierarchie" width="944" height="283">
</div>
</div>
</div>
<div class="sect3">
<h4 id="__code_java_nio_code"><a class="anchor" href="#__code_java_nio_code"></a>2.2.11. <code>java.nio</code></h4>
<div class="imageblock">
<div class="content">
<img src="figs/nio-fileiomethods.png" alt="nio fileiomethods">
</div>
</div>
<div class="paragraph">
<p>Source : <a href="https://docs.oracle.com/javase/tutorial/essential/io/file.html">Java Tutorial</a> - Reading, Writing, and Creating Files</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_utilisation_des_flux"><a class="anchor" href="#_utilisation_des_flux"></a>2.3. Utilisation des flux</h3>
<div class="sect3">
<h4 id="_principaux_flux_par_type_d_i_o"><a class="anchor" href="#_principaux_flux_par_type_d_i_o"></a>2.3.1. Principaux flux par type d&#8217;I/O</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type d&#8217;I/O</th>
<th class="tableblock halign-left valign-top">Flux de catactères</th>
<th class="tableblock halign-left valign-top">Flux d&#8217;octets</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Mémoire</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CharArrayReader</code>, <code>CharArrayWriter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ByteArrayInputStream</code>, <code>ByteArrayOutputStream</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>StringReader</code>, <code>StringWriter</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fichier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FileReader</code>, <code>FileWriter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FileInputStream</code>, <code>FileOutputStream</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Affichage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PrintWriter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PrintStream</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_principaux_flux_par_fonction"><a class="anchor" href="#_principaux_flux_par_fonction"></a>2.3.2. Principaux flux par fonction</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type d&#8217;I/O</th>
<th class="tableblock halign-left valign-top">Flux de catactères</th>
<th class="tableblock halign-left valign-top">Flux d&#8217;octets</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Avec buffer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BufferedReader</code>, <code>BufferedWriter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BufferedInputStream</code>, <code>BufferedOutputStream</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Conv. de données</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DataInputStream</code>, <code>DataOutputStream</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sérialisation</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ObjectInputStream</code>, <code>ObjectOutputStream</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Conv. oct./car.</p></td>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>InputStreamReader</code>, <code>OutputStreamWriter</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_flux_de_fichiers"><a class="anchor" href="#_flux_de_fichiers"></a>2.3.3. Flux de fichiers</h4>
<div class="ulist">
<ul>
<li>
<p>Les classes des flux de fichiers sont</p>
<div class="ulist">
<ul>
<li>
<p><code>FileReader/FileWriter</code> pour l&#8217;accès aux fichiers textes</p>
</li>
<li>
<p><code>FileInputStream/FileOutputStream</code> pour les fichiers binaires</p>
</li>
</ul>
</div>
</li>
<li>
<p>Un flux de fichier peut être créé</p>
<div class="ulist">
<ul>
<li>
<p>à partir d&#8217;un nom de fichier sous la forme d&#8217;une chaîne de caractères</p>
</li>
<li>
<p>d&#8217;une instance de <code>File</code></p>
</li>
<li>
<p>d&#8217;une méthode de classe de
<a href="http://docs.oracle.com/javase/8/docs/api/java/nio/file/Files.html"><code>java.nio.file.Files</code></a> (<code>newInputStream</code>, &#8230;&#8203;)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_copie_d_un_fichier_texte"><a class="anchor" href="#_copie_d_un_fichier_texte"></a>2.3.4. Copie d&#8217;un fichier texte</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">    /**
     * Copie un fichier caractère par caractère.
     */
    private static void textFileCopy(String inFilename, String outFilename) throws IOException {
        try (
                FileReader in = new FileReader(inFilename);
                FileWriter out = new FileWriter(outFilename)
        ) {
            int c;
            while ((c = in.read()) != END_OF_STREAM) {
                out.write(c);
            }
        }
    }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_copie_d_un_fichier_texte_avec_buffer"><a class="anchor" href="#_copie_d_un_fichier_texte_avec_buffer"></a>2.3.5. Copie d&#8217;un fichier texte (avec buffer)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">    /**
     * Copie un fichier en utilisant un buffer.
     */
    private static void bufferedTextFileCopy(String inFilename, String outFilename) throws IOException {
        Path inPath = Paths.get(inFilename);
        Path outPath = Paths.get(outFilename);
        try (
                BufferedReader in = Files.newBufferedReader(inPath);
                BufferedWriter out = Files.newBufferedWriter(outPath)
        ) {
            String line;
            while ((line = in.readLine()) != null) {
                out.write(line);
                out.newLine();
            }
        }
    }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_copie_d_un_fichier_texte_avec_readalllines"><a class="anchor" href="#_copie_d_un_fichier_texte_avec_readalllines"></a>2.3.6. Copie d&#8217;un fichier texte (avec readAllLines)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">    /**
     * Copie un fichier texte.
     * Le fichier doit être de taille raisonnable car il est chargé en totalité en mémoire.
     */
    private static void simpleTextFileCopy(String inFilename, String outFilename) throws IOException {
        Path inPath = Paths.get(inFilename);
        Path outPath = Paths.get(outFilename);
        List&lt;String&gt; lines = Files.readAllLines(inPath);
        Files.write(outPath, lines);
    }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_copie_d_un_fichier_binaire"><a class="anchor" href="#_copie_d_un_fichier_binaire"></a>2.3.7. Copie d&#8217;un fichier binaire</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">    /**
     * Copie un fichier octet par octet.
     */
    private static void binaryFileCopy(String inFilename, String outFilename) throws IOException {
        try (
                FileInputStream in = new FileInputStream(inFilename);
                FileOutputStream out = new FileOutputStream(outFilename)
        ) {
            int c;
            while ((c = in.read()) != END_OF_STREAM) {
                out.write(c);
            }
        }
    }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_flux_de_filtrage"><a class="anchor" href="#_flux_de_filtrage"></a>2.3.8. Flux de filtrage</h4>
<div class="ulist">
<ul>
<li>
<p>Certaines classes de flux sont destinées à appliquer un traitement sur (à <em>filtrer</em>) un flux</p>
</li>
<li>
<p>Les super-classes abstraites pour cela sont</p>
<div class="ulist">
<ul>
<li>
<p><code>FilterReader/FilterWriter</code> pour les caractères</p>
</li>
<li>
<p><code>FilterOutputStream/FilterInputStream</code> pour les octets</p>
</li>
</ul>
</div>
</li>
<li>
<p>Des flux personnalisés peuvent être définis en héritant de ces classes</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_principaux_flux_de_filtrage"><a class="anchor" href="#_principaux_flux_de_filtrage"></a>2.3.9. Principaux flux de filtrage</h4>
<div class="ulist">
<ul>
<li>
<p>Les principaux flux de filtrage pour les flux d&#8217;octets sont</p>
<div class="ulist">
<ul>
<li>
<p><code>DataInputStream</code> et <code>DataOutputStream</code> pour les I/O des types primitifs</p>
</li>
<li>
<p><code>BufferedInputStream</code> et <code>BufferedOutputStream</code> pour des I/O avec buffer</p>
</li>
<li>
<p><code>PrintStream</code> pour l&#8217;affichage des données</p>
</li>
<li>
<p><code>PushbackInputStream</code> pour pouvoir "annuler" la lecture d&#8217;une séquence d&#8217;octets</p>
</li>
</ul>
</div>
</li>
<li>
<p>Le seul flux de filtrage pour les flux de caractères est <code>PushbackReader</code> (permet d'"annuler" la lecture d&#8217;une séquence de caractères)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_flux_de_filtrage_et_modèle_de_conception_em_décorateur_em"><a class="anchor" href="#_flux_de_filtrage_et_modèle_de_conception_em_décorateur_em"></a>2.3.10. Flux de filtrage et modèle de conception <em>Décorateur</em></h4>
<div class="ulist">
<ul>
<li>
<p>Un flux de filtrage est construit à partir d&#8217;un autre flux selon le modèle de conception <a href="https://en.wikipedia.org/wiki/Decorator_pattern"><em>Décorateur</em></a></p>
</li>
<li>
<p>Le flux résultant propose des fonctionnalités plus riches que le flux initial</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">FileInputStream words = new FileInputStream("words.dat");
BufferedInputStream in = new BufferedInputStream(words);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ecriture_des_types_primitifs"><a class="anchor" href="#_ecriture_des_types_primitifs"></a>2.3.11. Ecriture des types primitifs</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">    public static void writeDateToFile(String filename, int numberOfItems, double[] prices, int[] units, String[] descs) throws IOException {
        try (DataOutputStream out =
                     new DataOutputStream(
                             new BufferedOutputStream(
                                     new FileOutputStream(filename)))
        ) {
            for (int i = 0; i &lt; numberOfItems; i++) {
                out.writeDouble(prices[i]);
                out.writeInt(units[i]);
                out.writeUTF(descs[i]);
            }
        }
    }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_lecture_des_types_primitifs"><a class="anchor" href="#_lecture_des_types_primitifs"></a>2.3.12. Lecture des types primitifs</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">    public static void readDateFromFile(String filename, int numberOfItems, double[] prices, int[] units, String[] descs) throws IOException {
        try (DataInputStream out =
                     new DataInputStream(
                             new BufferedInputStream(
                                     new FileInputStream(filename)))
        ) {
            for (int i = 0; i &lt; numberOfItems; i++) {
                prices[i] = out.readDouble();
                units[i] = out.readInt();
                descs[i] = out.readUTF();
            }
        }
    }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_entrée_et_sortie_standards_en_java"><a class="anchor" href="#_entrée_et_sortie_standards_en_java"></a>2.3.13. Entrée et sortie standards en Java</h4>
<div class="paragraph">
<p>La classe <code>System</code> fournit des flux pour :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>l&#8217;entrée standard (attribut <code>in</code> de type <code>PrintStream</code>)</p>
</li>
<li>
<p>la sortie standard (attribut <code>out</code> de type <code>InputStream</code>)</p>
</li>
<li>
<p>la sortie d&#8217;erreurs (attribut <code>err</code> de type <code>PrintStream</code>)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_flux_d_affichage_code_printstream_code_ou_code_printwriter_code"><a class="anchor" href="#_flux_d_affichage_code_printstream_code_ou_code_printwriter_code"></a>2.3.14. Flux d&#8217;affichage <code>PrintStream</code> (ou <code>PrintWriter</code>)</h4>
<div class="ulist">
<ul>
<li>
<p><code>PrintStream format( /* &#8230;&#8203; */)</code> affiche une chaîne selon un format</p>
<div class="ulist">
<ul>
<li>
<p>cf.  <a href="http://docs.oracle.com/javase/8/docs/api/java/util/Formatter.html"><code>java.util.Formatter</code></a></p>
</li>
<li>
<p><code>PrintStream printf(/* &#8230;&#8203; */)</code> fait la même chose</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>void print(/* &#8230;&#8203; */)</code> affiche différents types de données sur le flux</p>
<div class="ulist">
<ul>
<li>
<p><code>void println(/* &#8230;&#8203; */)</code> idem mais suivi d&#8217;un retour à la ligne</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>PrintStream append(/* &#8230;&#8203; */)</code> ajoute des caractères au flux</p>
</li>
<li>
<p><code>void flush()</code> force la sortie des caractères</p>
</li>
<li>
<p>Ne lancent jamais d&#8217;exception mais positionnent un indicateur interne</p>
<div class="ulist">
<ul>
<li>
<p>interrogeable avec la méthode <code>boolean checkError()</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_lire_à_partir_de_l_entrée_standard"><a class="anchor" href="#_lire_à_partir_de_l_entrée_standard"></a>2.3.15. Lire à partir de l&#8217;entrée standard</h4>
<div class="ulist">
<ul>
<li>
<p>L&#8217;entrée standard est utilisée en décorant <code>System.in</code> avec <code>InputStreamReader</code>
(voire avec <code>BufferedReader</code>)</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">InputStreamReader stdin = new InputStreamReader(System.in);
BufferedReader bufferedStdin = new BufferedReader(stdin));</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>La classe <a href="http://docs.oracle.com/javase/8/docs/api/java/util/Scanner.html"><code>java.util.Scanner</code></a> simplifie le processus de saisie</p>
<div class="ulist">
<ul>
<li>
<p>permet de découper un flux en <em>token</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_accéder_à_l_entrée_et_la_sortie_standard_avec_scanner"><a class="anchor" href="#_accéder_à_l_entrée_et_la_sortie_standard_avec_scanner"></a>2.3.16. Accéder à l&#8217;entrée et la sortie standard (avec Scanner)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">        System.out.println("Votre nom et votre âge ? ");

        Scanner s = new Scanner(System.in);
        String nom = s.next();
        int age = s.nextInt();

        System.out.format("Votre nom est %s et vous avez %5d ans.%n", nom, age);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_accéder_à_l_entrée_et_la_sortie_standard_avec_bufferedreader"><a class="anchor" href="#_accéder_à_l_entrée_et_la_sortie_standard_avec_bufferedreader"></a>2.3.17. Accéder à l&#8217;entrée et la sortie standard (avec BufferedReader)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">        System.out.println("Votre nom et votre age ? ");

        BufferedReader in = new BufferedReader(new InputStreamReader(System.in));
        String nom = in.readLine();
        int age = Integer.parseInt(in.readLine());

        System.out.format("Votre nom est %s et vous avez %5d ans.%n", nom, age);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_utiliser_la_classe_code_console_code"><a class="anchor" href="#_utiliser_la_classe_code_console_code"></a>2.3.18. Utiliser la classe <code>Console</code></h4>
<div class="ulist">
<ul>
<li>
<p>La classe <a href="http://docs.oracle.com/javase/8/docs/api/index.html?java/io/BufferedReader.html"><code>Console</code></a> est une alternative pour l&#8217;accès à l&#8217;entrée et à la sortie standard</p>
</li>
<li>
<p>Un objet de ce type est initialisé avec la méthode <code>System.console()</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">Console c = System.console();
if (c == null) {
    System.err.println("No console.");
    System.exit(1);
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sérialisation_en_java"><a class="anchor" href="#_sérialisation_en_java"></a>2.4. Sérialisation en Java</h3>
<div class="sect3">
<h4 id="_sérialisation_2"><a class="anchor" href="#_sérialisation_2"></a>2.4.1. Sérialisation</h4>
<div class="ulist">
<ul>
<li>
<p>La sérialisation est assurée par les classes <code>ObjectInputStream</code> et <code>ObjectOutputStream</code></p>
</li>
<li>
<p><code>ObjectOutputStream</code> implémente les interfaces <code>DataOutput</code> et <code>ObjectOutput</code></p>
</li>
<li>
<p><code>ObjectInputStream</code> implémente les interfaces <code>DataInput</code> et <code>ObjectInput</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_ecrire_des_objets_dans_un_flux"><a class="anchor" href="#_ecrire_des_objets_dans_un_flux"></a>2.4.2. Ecrire des objets dans un flux</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">    private static void writeObjectsToFile(Student[] students, String filename) throws IOException {
        try (ObjectOutputStream oos =
                     new ObjectOutputStream(
                             new FileOutputStream(filename))
        ) {
            oos.writeObject(LocalDate.now());
            oos.writeObject(students);
        }
    }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_lire_des_objets_à_partir_d_un_flux"><a class="anchor" href="#_lire_des_objets_à_partir_d_un_flux"></a>2.4.3. Lire des objets à partir d&#8217;un flux</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">    private static LocalDate readObjectsFromFile(Student[] students, String filename) throws IOException, ClassNotFoundException {
        try (ObjectInputStream ois =
                     new ObjectInputStream(
                             new FileInputStream(filename))
        ) {
            LocalDate date = (LocalDate) ois.readObject();
            students = (Student[]) ois.readObject();
            return date;
        }
    }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_rendre_une_classe_sérialisable"><a class="anchor" href="#_rendre_une_classe_sérialisable"></a>2.4.4. Rendre une classe sérialisable</h4>
<div class="ulist">
<ul>
<li>
<p>Un objet est sérialisable uniquement si sa classe implémente l&#8217;interface <code>Serializable</code></p>
</li>
<li>
<p>L&#8217;interface <code>Serializable</code> ne comporte aucune méthode et ne sert qu&#8217;à spécifier les classes sérialisables</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_une_classe_sérialisable"><a class="anchor" href="#_une_classe_sérialisable"></a>2.4.5. Une classe sérialisable</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">package fr.uvsq.info.poo.io;

import java.io.Serializable;

public class Student implements Serializable {
    private int number;
    private String name;

    public Student(int number, String name) {
        this.number = number;
        this.name = name;
    }

    @Override
    public String toString() {
        return String.format("Student{number: %d, name: '%s'}", number, name);
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_gérer_la_version_des_classes"><a class="anchor" href="#_gérer_la_version_des_classes"></a>2.4.6. Gérer la version des classes</h4>
<div class="ulist">
<ul>
<li>
<p>L&#8217;attribut de classe <a href="http://docs.oracle.com/javase/8/docs/api/java/io/Serializable.html"><code>serialVersionUID</code></a> précise la version d&#8217;une classe sérialisable</p>
</li>
<li>
<p>Il permet de déterminer si un objet correspond bien à la classe présente dans la JVM</p>
</li>
<li>
<p>Il est généré par la JVM s&#8217;il n&#8217;est pas défini dans la classe</p>
</li>
<li>
<p>Le développeur peut gérer les versions lui-même</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">private static final long serialVersionUID = 354054054054L;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_contrôler_la_sérialisation"><a class="anchor" href="#_contrôler_la_sérialisation"></a>2.4.7. Contrôler la sérialisation</h4>
<div class="ulist">
<ul>
<li>
<p>La sérialisation est gérée par les méthodes</p>
<div class="ulist">
<ul>
<li>
<p><code>defaultWriteObject</code> de <code>ObjectOutputStream</code></p>
</li>
<li>
<p><code>defaultReadObject</code> de <code>ObjectInputStream</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Le comportement par défaut de la sérialisation d&#8217;un objet est de stocker</p>
<div class="ulist">
<ul>
<li>
<p>la classe de l&#8217;objet</p>
</li>
<li>
<p>la signature de la classe</p>
</li>
<li>
<p>la valeur des attributs d&#8217;instances y compris les références (mais pas les attributs <code>transcient</code>)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Il est possible d&#8217;adapter le comportement par défaut en redéfinissant <code>writeObject</code> et <code>readObject</code></p>
</li>
<li>
<p>L&#8217;interface <code>Externalizable</code> permet d&#8217;avoir un contrôle complet du processus de sérialisation</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exercices_2"><a class="anchor" href="#_exercices_2"></a>2.5. Exercices</h3>
<div class="sect3">
<h4 id="_utilisation_des_flux_de_caractères"><a class="anchor" href="#_utilisation_des_flux_de_caractères"></a>2.5.1. Utilisation des flux de caractères</h4>
<div class="paragraph">
<p>Le but de cette exercice est de réaliser quelques outils de manipulation de fichiers textes.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Écrire un programme prenant en argument un nom de fichier et affichant le nombre de lignes de ce fichier.
Quelle classe du package <code>java.io</code> vous sera utile pour cette tâche ?</p>
</li>
<li>
<p>Ècrire un programme prenant en argument une chaîne de caractères et un nom de fichier et qui affiche les lignes (avec leur numéro) du fichier contenant la chaîne.
Quelle classe du package <code>java.io</code> vous sera utile pour cette tâche ?</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_implémentation_d_un_flux_de_filtrage"><a class="anchor" href="#_implémentation_d_un_flux_de_filtrage"></a>2.5.2. Implémentation d&#8217;un flux de filtrage</h4>
<div class="paragraph">
<p>Cette exercice consiste à implémenter une commande <code>grep</code> simplifiée.
Parmi les nombreuses options de cette commande, vous implémenterez le sous-ensemble suivant
(cf. <a href="http://manpagesfr.free.fr/man/man1/grep.1.html">page de manuel</a>) :
<code>--help</code>, <code>-e|--regexp</code>, <code>-f|--file</code>, <code>-i|--ignore-case</code>, <code>-n|--line-number</code>.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Vous utiliserez la bibliothèque</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://commons.apache.org/cli/">Apache Commons CLI</a> pour la manipulation des arguments de ligne de commande,</p>
</li>
<li>
<p>de manipulation d&#8217;expressions rationnelles du JDK (cf.
<a href="http://docs.oracle.com/javase/tutorial/essential/regex/index.html">Tutoriel</a>).</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Questions</div>
<ol class="arabic">
<li>
<p>Réalisez le flux de filtrage <code>GrepReader</code> qui lit un flux en retournant uniquement les lignes correspondant au motif recherché</p>
</li>
<li>
<p>Réaliser la classe principale <code>GrepApp</code></p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_gestion_des_collections"><a class="anchor" href="#_gestion_des_collections"></a>3. Gestion des collections</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introduction"><a class="anchor" href="#_introduction"></a>3.1. Introduction</h3>
<div class="sect3">
<h4 id="_collection"><a class="anchor" href="#_collection"></a>3.1.1. Collection</h4>
<div class="ulist">
<ul>
<li>
<p>Une <em>collection</em> (<em>conteneur</em>) est un objet qui regroupe plusieurs éléments en une seule unité</p>
</li>
<li>
<p>Une collection peut être utilisée pour stocker et manipuler des données et pour transmettre des données d&#8217;une méthode à une autre</p>
</li>
<li>
<p>Une collection regroupe généralement des objets de même type</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_bibliothèques_pour_les_collections"><a class="anchor" href="#_bibliothèques_pour_les_collections"></a>3.1.2. Bibliothèques pour les collections</h4>
<div class="ulist">
<ul>
<li>
<p>Une <em>bibliothèque pour les collections</em> (<em>collection framework</em>) est une architecture unifiée pour représenter et manipuler des collections</p>
</li>
<li>
<p>Elle différencie trois composants :</p>
<div class="ulist">
<ul>
<li>
<p>des <em>interfaces</em> permettent de manipuler des collections indépendamment de leurs implémentations</p>
</li>
<li>
<p>des <em>implémentations</em> représentent les structures de données proprement dites</p>
</li>
<li>
<p>des <em>algorithmes</em> effectuent des traitements par l&#8217;intermédiaire des interfaces</p>
</li>
</ul>
</div>
</li>
<li>
<p>Ce type de bibliothèque s&#8217;appuie en général sur la généricité pour le contrôle des types</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_quelques_exemples_de_bibliothèques_pour_les_collections"><a class="anchor" href="#_quelques_exemples_de_bibliothèques_pour_les_collections"></a>3.1.3. Quelques exemples de bibliothèques pour les collections</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Java</dt>
<dd>
<p><a href="http://docs.oracle.com/javase/8/docs/technotes/guides/collections/overview.html"><em>Java Collections Framework</em></a>,
<a href="https://commons.apache.org/proper/commons-collections/"><em>Apache Commons Collections</em></a>,
<a href="https://github.com/google/guava/wiki"><em>Google Guava</em></a></p>
</dd>
<dt class="hdlist1">C++</dt>
<dd>
<p><a href="http://www.cplusplus.com/reference/stl/"><em>Standard Containers</em></a> de la STL (<em>Standard Template Library</em>),
<a href="http://www.boost.org/"><em>Boost</em></a></p>
</dd>
<dt class="hdlist1">Python</dt>
<dd>
<p>built-in containers <a href="https://docs.python.org/3/library/stdtypes.html#dict"><code>dict</code></a>,
<a href="https://docs.python.org/3/library/stdtypes.html#list"><code>list</code></a>,
<a href="https://docs.python.org/3/library/stdtypes.html#set"><code>set</code></a>, and
<a href="https://docs.python.org/3/library/stdtypes.html#tuple"><code>tuple</code></a></p>
</dd>
<dt class="hdlist1">C#</dt>
<dd>
<p><a href="https://msdn.microsoft.com/fr-fr/library/mt654013.aspx"><em>Collections</em></a></p>
</dd>
<dt class="hdlist1">Rust</dt>
<dd>
<p><a href="https://doc.rust-lang.org/std/collections/"><code>std::collections</code></a></p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_motivations"><a class="anchor" href="#_motivations"></a>3.1.4. Motivations</h4>
<div class="imageblock">
<div class="content">
<img src="figs/axes.svg" alt="axes">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>\$i xx j\$ versions différentes du même algorithme pour supporter tous les conteneurs</p>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
&#8658;
</td>
<td class="hdlist2">
<p>pour <em>k</em> algorithmes, \$i xx j xx k\$ programmes</p>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>La généricité permet de paramétrer par rapport aux types</p>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
&#8658;
</td>
<td class="hdlist2">
<p>réduit à \$j xx k\$ programmes</p>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Abstraction de la notion de collection (un algo. fonctionne sur toute collection)</p>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
&#8658;
</td>
<td class="hdlist2">
<p>réduit à \$j + k\$ programmes</p>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_intérêt_d_une_bibliothèque_pour_les_collections_1_2"><a class="anchor" href="#_intérêt_d_une_bibliothèque_pour_les_collections_1_2"></a>3.1.5. Intérêt d&#8217;une bibliothèque pour les collections 1/2</h4>
<div class="ulist">
<ul>
<li>
<p>Réduit l&#8217;effort de programmation</p>
<div class="ulist">
<ul>
<li>
<p>fournit des SDD et des algorithmes permettant de se concentrer sur les parties importantes d&#8217;un problème sans s&#8217;occuper de détails d&#8217;implémentation</p>
</li>
</ul>
</div>
</li>
<li>
<p>Améliore la qualité et les performances du programme</p>
<div class="ulist">
<ul>
<li>
<p>fournit des SDD et des algorithmes de haute qualité et efficaces.</p>
</li>
<li>
<p>il est aussi possible de remplacer simplement une SDD par une autre</p>
</li>
</ul>
</div>
</li>
<li>
<p>Permet l&#8217;interopérabilité d&#8217;API</p>
<div class="ulist">
<ul>
<li>
<p>Les API peuvent échanger des collections</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_intérêt_d_une_bibliothèque_pour_les_collections_2_2"><a class="anchor" href="#_intérêt_d_une_bibliothèque_pour_les_collections_2_2"></a>3.1.6. Intérêt d&#8217;une bibliothèque pour les collections 2/2</h4>
<div class="ulist">
<ul>
<li>
<p>Réduit l&#8217;effort d&#8217;apprentissage et d&#8217;utilisation</p>
<div class="ulist">
<ul>
<li>
<p>permet de se concentrer sur une seule API</p>
</li>
</ul>
</div>
</li>
<li>
<p>Réduit l&#8217;effort de conception de nouvelles API</p>
<div class="ulist">
<ul>
<li>
<p>les nouvelles API s&#8217;appuient sur les collections existantes</p>
</li>
</ul>
</div>
</li>
<li>
<p>Améliore la réutilisabilité du logiciel</p>
<div class="ulist">
<ul>
<li>
<p>une nouvelle SDD ou un nouvel algorithme s&#8217;intégrant dans la bibliothèque est immédiatement utilisable avec le reste</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_collections_en_java"><a class="anchor" href="#_collections_en_java"></a>3.1.7. Collections en Java</h4>
<div class="imageblock">
<div class="content">
<img src="figs/collections.png" alt="collections">
</div>
</div>
<div class="paragraph">
<p>Source : <a href="http://www.novixys.com/blog/java-collections/">Java Collections</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_dictionnaires_en_java"><a class="anchor" href="#_dictionnaires_en_java"></a>3.1.8. Dictionnaires en Java</h4>
<div class="imageblock">
<div class="content">
<img src="figs/maps.png" alt="maps">
</div>
</div>
<div class="paragraph">
<p>Source : <a href="http://www.novixys.com/blog/java-collections/">Java Collections</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_caractéristiques_communes"><a class="anchor" href="#_caractéristiques_communes"></a>3.1.9. Caractéristiques communes</h4>
<div class="ulist">
<ul>
<li>
<p>Une collection Java ne peut pas contenir une donnée d&#8217;un type primitif (uniquement des objets)</p>
</li>
<li>
<p>Les composants de la bibliothèque de collections se trouvent dans <code>java.util</code></p>
</li>
<li>
<p>Le découpage interface/implémentation repose sur le modèle de conception <a href="https://en.wikipedia.org/wiki/Bridge_pattern">Pont</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_interfaces"><a class="anchor" href="#_interfaces"></a>3.2. Interfaces</h3>
<div class="sect3">
<h4 id="_les_interfaces"><a class="anchor" href="#_les_interfaces"></a>3.2.1. Les interfaces</h4>
<div class="ulist">
<ul>
<li>
<p>Les interfaces sont utilisées pour manipuler des collections et les transmettre d&#8217;une méthode à une autre</p>
</li>
<li>
<p>Les interfaces permettent de manipuler les collections indépendamment des différentes implémentations</p>
<div class="ulist">
<ul>
<li>
<p>représente les types de structures de données</p>
</li>
<li>
<p>il est préférable de manipuler les collections par les interfaces plutôt que par les implémentations</p>
</li>
</ul>
</div>
</li>
<li>
<p>Une implémentation a la possibilité de ne pas supporter toutes les méthodes de modification de l&#8217;interface (lancement de l&#8217;exception <code>UnsupportedOperationException</code>)</p>
</li>
<li>
<p>Les implémentations du JDK implémentent toutes les méthodes optionnelles</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_la_hiérarchie_de_code_collection_code"><a class="anchor" href="#_la_hiérarchie_de_code_collection_code"></a>3.2.2. La hiérarchie de <code>Collection</code></h4>
<div class="imageblock">
<div class="content">
<img src="figs/collection-hierarchie.svg" alt="collection hierarchie" width="327" height="497">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Iterable</code> autorise l&#8217;utilisation du <em>foreach</em></p>
</li>
<li>
<p>D&#8217;autres interfaces existent mais sont liées à la concurrence</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_la_hiérarchie_de_code_map_code"><a class="anchor" href="#_la_hiérarchie_de_code_map_code"></a>3.2.3. La hiérarchie de <code>Map</code></h4>
<div class="imageblock">
<div class="content">
<img src="figs/map-hierarchie.svg" alt="map hierarchie" width="145" height="281">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>La hiérarchie de <code>Map</code> représentent des tableaux associatifs (dictionnaires)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_l_interface_code_collection_code_1_2"><a class="anchor" href="#_l_interface_code_collection_code_1_2"></a>3.2.4. L&#8217;interface <code>Collection</code> 1/2</h4>
<div class="ulist">
<ul>
<li>
<p>L&#8217;interface <code>Collection</code> est la racine de la hiérarchie de collection</p>
</li>
<li>
<p>Le JDK ne fournit pas d&#8217;implémentation spécifique pour cette interface</p>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
&#8658;
</td>
<td class="hdlist2">
<p>toutes les implémentations conviennent</p>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>C&#8217;est le plus petit dénominateur commun pour les implémentations</p>
</li>
<li>
<p>Elle doit être utilisée quand un maximum de généralité est souhaitée</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_l_interface_code_collection_code_2_2"><a class="anchor" href="#_l_interface_code_collection_code_2_2"></a>3.2.5. L&#8217;interface <code>Collection</code> 2/2</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">public interface Collection&lt;E&gt; extends Iterable&lt;E&gt; {
  // Opérations simples
  int size();
  boolean isEmpty();
  boolean contains(Object element);
  boolean add(E element);    // Optionnel
  boolean remove(Object element); // Optionnel
  boolean equals(Object o);
  int hashCode();
  Iterator&lt;E&gt; iterator();

  // Opérations de groupe
  boolean containsAll(Collection&lt;?&gt; c);
  boolean addAll(Collection&lt;? extends E&gt; c);    // Optionnel
  boolean removeAll(Collection&lt;?&gt; c); // Optionnel
  default boolean removeIf(Predicate&lt;? super E&gt; filter);
  boolean retainAll(Collection&lt;?&gt; c); // Optionnel
  void clear();    // Optionnel

  // Conversions
  Object[] toArray();
  &lt;T&gt; T[] toArray(T[] a);

  // Itération et Streams
  Iterator&lt;E&gt; iterator();
  default Spliterator&lt;E&gt; spliterator();
  default Stream&lt;E&gt; stream();
  default Stream&lt;E&gt; parallelStream();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_parcourir_des_collections"><a class="anchor" href="#_parcourir_des_collections"></a>3.2.6. Parcourir des collections</h4>
<div class="paragraph">
<p>Trois techniques permettent de parcourir des collections</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Les <em>Streams</em></p>
</li>
<li>
<p>La boucle <em>for-each</em></p>
</li>
<li>
<p>Les itérateurs</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_les_em_streams_em"><a class="anchor" href="#_les_em_streams_em"></a>3.2.7. Les <em>Streams</em></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">String joined = elements.stream()
    .filter(e -&gt; e.getColor() == Color.RED)
    .map(Object::toString)
    .collect(Collectors.joining(", "));</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Plus de détails dans le chapitre suivant</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_boucle_em_for_each_em"><a class="anchor" href="#_boucle_em_for_each_em"></a>3.2.8. Boucle <em>for-each</em></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">for (String element : uneCollectionDeChaines) {
    // Manipuler element
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>La boucle <em>for-each</em> ne permet pas de modifier la collection lors de l&#8217;itération</p>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
&#8658;
</td>
<td class="hdlist2">
<p>utiliser un itérateur dans ce cas</p>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_itérateur"><a class="anchor" href="#_itérateur"></a>3.2.9. Itérateur</h4>
<div class="ulist">
<ul>
<li>
<p>Un <em>itérateur</em> permet de parcourir une collection</p>
</li>
<li>
<p>La notion d&#8217;itérateur est implantée en Java par l&#8217;interface <code>Iterator</code></p>
</li>
<li>
<p>Un itérateur peut être vu comme un marqueur se trouvant entre deux éléments</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">public interface Iterator&lt;E&gt; {
    boolean hasNext();
    E next();
    default void remove() {
        throw new UnsupportedOperationException("remove");
    }
    default void forEachRemaining(Consumer&lt;? super E&gt; action) {
        Objects.requireNonNull(action);
        while (hasNext())
            action.accept(next());
    }
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>L&#8217;utilisation de <code>remove</code> est le seul moyen sûr de modifier une collection lors du parcours</p>
</li>
<li>
<p>On ne peut utiliser <code>remove()</code> qu&#8217;une seule fois par appel à <code>next()</code></p>
</li>
<li>
<p>Un itérateur est basé sur le modèle de conception <a href="https://en.wikipedia.org/wiki/Iterator_pattern">Itérateur</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_parcours_d_une_collection_avec_un_itérateur"><a class="anchor" href="#_parcours_d_une_collection_avec_un_itérateur"></a>3.2.10. Parcours d&#8217;une collection avec un itérateur</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">  for (Iterator&lt;String&gt; i = uneCollectionDeChaines.iterator(); i.hasNext(); ) {
    String element = i.next(); // Récupère l'élément et passe au suivant
    // ...
  }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_l_interface_code_set_code"><a class="anchor" href="#_l_interface_code_set_code"></a>3.2.11. L&#8217;interface <code>Set</code></h4>
<div class="ulist">
<ul>
<li>
<p>L&#8217;interface <code>Set</code> représente une collection sans duplicat</p>
<div class="ulist">
<ul>
<li>
<p>modélise le concept mathématique d&#8217;ensemble</p>
</li>
</ul>
</div>
</li>
<li>
<p>L&#8217;interface <code>Set</code> n&#8217;ajoute aucune méthode à l&#8217;interface <code>Collection</code></p>
</li>
<li>
<p>Deux ensembles sont égaux s&#8217;ils contiennent les mêmes éléments</p>
</li>
<li>
<p>Sémantique des méthodes de groupe</p>
<div class="ulist">
<ul>
<li>
<p><code>s1.containsAll(s2)</code> retourne <code>true</code> si \$s_2 sube s_1\$</p>
</li>
<li>
<p><code>s1.addAll(s2)</code> transforme s1 en \$s_1 uu s_2\$</p>
</li>
<li>
<p><code>s1.retainAll(s2)</code> transforme s1 en \$s_1 nn s_2\$</p>
</li>
<li>
<p><code>s1.removeAll(s2)</code> transforme s1 en \$s_1 \\ s_2\$</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_l_interface_code_list_code_1_2"><a class="anchor" href="#_l_interface_code_list_code_1_2"></a>3.2.12. L&#8217;interface <code>List</code> 1/2</h4>
<div class="ulist">
<ul>
<li>
<p>L&#8217;interface <code>List</code> représente une <em>séquence</em> d&#8217;éléments, i.e. une collection ordonnée</p>
</li>
<li>
<p>L&#8217;interface <code>List</code> possède des opérations pour:</p>
<div class="ulist">
<ul>
<li>
<p>accéder aux éléments d&#8217;une liste par leurs indices</p>
</li>
<li>
<p>retourner l&#8217;indice d&#8217;un objet que l&#8217;on recherche</p>
</li>
<li>
<p>étendre la sémantique des itérateurs</p>
</li>
<li>
<p>manipuler des sous-listes</p>
</li>
</ul>
</div>
</li>
<li>
<p>Deux listes sont égales si elles possèdent les mêmes éléments dans le même ordre</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_l_interface_code_list_code_2_2"><a class="anchor" href="#_l_interface_code_list_code_2_2"></a>3.2.13. L&#8217;interface <code>List</code> 2/2</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">public interface List&lt;E&gt; extends Collection&lt;E&gt; {
  // Accès par position
  E get(int index);
  E set(int index, E element);            // Optionnel
  void add(int index, E element);              // Optionnel
  E remove(int index);                         // Optionnel
  boolean addAll(int index, Collection&lt;? extends E&gt; c); // Optionnel

  // Opération de groupe
  default void replaceAll(UnaryOperator&lt;E&gt; operator) {
        Objects.requireNonNull(operator);
        final ListIterator&lt;E&gt; li = this.listIterator();
        while (li.hasNext()) {
            li.set(operator.apply(li.next()));
        }
    }
  default void sort(Comparator&lt;? super E&gt; c) {
        Collections.sort(this, c);
    }

  // Recherche
  int indexOf(Object o);
  int lastIndexOf(Object o);

  // Itération
  ListIterator&lt;E&gt; listIterator();
  ListIterator&lt;E&gt; listIterator(int index);

  // Vue en sous-liste
  List&lt;E&gt; subList(int from, int to);
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_itérateur_de_liste"><a class="anchor" href="#_itérateur_de_liste"></a>3.2.14. Itérateur de liste</h4>
<div class="ulist">
<ul>
<li>
<p>L&#8217;interface <code>ListIterator</code> étend l&#8217;interface <code>Iterator</code> pour permettre un parcours dans les deux sens</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">public interface ListIterator&lt;E&gt; extends Iterator&lt;E&gt; {
    boolean hasPrevious();
    E previous();

    int nextIndex();
    int previousIndex();

    void set(E o);     // Optionnel
    void add(E o);     // Optionnel
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_l_interface_code_queue_code"><a class="anchor" href="#_l_interface_code_queue_code"></a>3.2.15. L&#8217;interface <code>Queue</code></h4>
<div class="ulist">
<ul>
<li>
<p>L&#8217;interface <code>Queue</code> représente une file</p>
</li>
<li>
<p>Les méthodes sont proposées sous deux formes</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top">lance une exception</th>
<th class="tableblock halign-left valign-top">retourne une valeur spéciale</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Insertion</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>add(e)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>offer(e)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Suppression</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>remove()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>poll()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Accès</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>element()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>peek()</code></p></td>
</tr>
</tbody>
</table>
<div class="ulist">
<ul>
<li>
<p>La stratégie d&#8217;insertion/suppression est définie par l&#8217;implémentation</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_l_interface_code_dequeue_code"><a class="anchor" href="#_l_interface_code_dequeue_code"></a>3.2.16. L&#8217;interface <code>DeQueue</code></h4>
<div class="ulist">
<ul>
<li>
<p>L&#8217;interface <code>DeQueue</code> représente une file à double entrée</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top" colspan="2">Accès en tête</th>
<th class="tableblock halign-left valign-top" colspan="2">Accès en queue</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exception</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Valeur spéciale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exception</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Valeur spéciale</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Insertion</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>addFirst(e)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>offerFirst(e)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>addLast(e)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>offerLast(e)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Suppression</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>removeFirst()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pollFirst()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>removeLast()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pollLast()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Accès</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getFirst()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>peekFirst()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getLast()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>peekLast()</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_l_interface_code_map_code_1_2"><a class="anchor" href="#_l_interface_code_map_code_1_2"></a>3.2.17. L&#8217;interface <code>Map</code> 1/2</h4>
<div class="ulist">
<ul>
<li>
<p>L&#8217;interface <code>Map</code> représente un <em>tableau associatif</em> (<em>dictionnaire</em>)</p>
<div class="ulist">
<ul>
<li>
<p>i.e. un objet qui associe une clé à chaque valeur</p>
</li>
</ul>
</div>
</li>
<li>
<p>Une clé peut correspondre à au plus une valeur</p>
<div class="ulist">
<ul>
<li>
<p>pas de multi-map en Java &#8658; utiliser une map avec une liste de valeurs associées à chaque clé</p>
</li>
</ul>
</div>
</li>
<li>
<p>Deux tableaux associatifs sont égaux s&#8217;ils représentent les mêmes associations clé/valeur</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Les objets mutables comme clés d&#8217;une <code>Map</code> peuvent poser problème
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_l_interface_code_map_code_2_2"><a class="anchor" href="#_l_interface_code_map_code_2_2"></a>3.2.18. L&#8217;interface <code>Map</code> 2/2</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">public interface Map&lt;K, V&gt; {
  // Opérations de base
  int size();
  boolean isEmpty();
  V put(K key, V value);
  V get(Object key);
  V remove(Object key);
  boolean containsKey(Object key);
  boolean containsValue(Object value);

  // Opérations sur des groupes
  void putAll(Map&lt;? extends K,? extends V&gt; t);
  void clear();

  // Vues
  public Set&lt;K&gt; keySet();
  public Collection&lt;V&gt; values();
  public Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet();

  // Interface pour entrySet
  public interface Entry&lt;K, V&gt; {
    K getKey();
    V getValue();
    V setValue(V value);
  }

  // + des méthodes par défaut
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_parcourir_une_code_map_code"><a class="anchor" href="#_parcourir_une_code_map_code"></a>3.2.19. Parcourir une <code>Map</code></h4>
<div class="ulist">
<ul>
<li>
<p>Les méthodes de <em>vue comme collection</em> permettent de voir une <code>Map</code> comme une collection de trois façons différentes</p>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>keySet</code>
</td>
<td class="hdlist2">
<p>représente l'<strong>ensemble</strong> des clés</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>values</code>
</td>
<td class="hdlist2">
<p>représente la <strong>collection</strong> des valeurs</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>entrySet</code>
</td>
<td class="hdlist2">
<p>représente l&#8217;ensemble des couples <em>(clé, valeur)</em></p>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Ces méthodes fournissent un moyen pour parcourir une <code>Map</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_construire_l_histogramme_d_une_image"><a class="anchor" href="#_construire_l_histogramme_d_une_image"></a>3.2.20. Construire l&#8217;histogramme d&#8217;une image</h4>
<div class="listingblock">
<div class="title">Méthode de construction de l&#8217;histogramme</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">    /**
     * Produit l'histogramme d'une image.
     *
     * @param img l'image à analyser
     * @return l'histogramme de l'image sous la forme d'un dictionnaire (couleur, fréquence)
     */
    public static Map&lt;Integer, Long&gt; frequency(int[][] img) {
        Stream&lt;Integer&gt; imgColors = Arrays.stream(img)
                .flatMap(c -&gt; Arrays.stream(c).boxed());
        Map&lt;Integer, Long&gt; frequencyMap = imgColors.collect(
                Collectors.groupingBy(
                        Function.identity(), Collectors.counting()
                )
        );
        return frequencyMap;
    }</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Manipulation de l&#8217;histogramme</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">        int[][] image = {
                {0, 1, 12, 1},
                {1, 12, 12, 12},
                {0, 12, 12, 0}
        };

        Map&lt;Integer, Long&gt; histogramme = frequency(image);
        System.out.println(histogramme); // {0=3, 1=3, 12=6}
        System.out.println(histogramme.keySet()); // [0, 1, 12]

        Optional&lt;Long&gt; max = histogramme.values().stream()
                .max(Comparator.naturalOrder());
        System.out.format("Fréq. max. : %d%n", max.orElse(-1L)); // Fréq. max. : 6</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ordonner_des_objets"><a class="anchor" href="#_ordonner_des_objets"></a>3.2.21. Ordonner des objets</h4>
<div class="ulist">
<div class="title">Le problème</div>
<ul>
<li>
<p>Comment ordonner des objets selon leur <em>ordre naturel</em> (lexicographique pour les chaînes, chronologique pour les dates, &#8230;&#8203;) ?</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">En Java</div>
<ul>
<li>
<p>La solution proposée est d&#8217;implémenter l&#8217;interface <code>Comparable</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_l_interface_code_comparable_code"><a class="anchor" href="#_l_interface_code_comparable_code"></a>3.2.22. L&#8217;interface <code>Comparable</code></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">public interface Comparable&lt;T&gt; {
  public int compareTo(&lt;T&gt; o);
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>La plupart des classes de la librairie Java implémentent cette interface</p>
</li>
<li>
<p><code>compareTo</code> doit retourner un entier négatif (respectivement zéro, un entier positif) si l&#8217;objet est inférieur (respectivement égal, supérieur) au paramètre</p>
</li>
<li>
<p>Si l&#8217;argument n&#8217;est pas du bon type, <code>compareTo</code> doit lancer l&#8217;exception <code>ClassCastException</code></p>
</li>
<li>
<p>L&#8217;ordre ainsi défini doit induire un <em>ordre partiel</em> (cf. la documentation de <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Comparable.html"><code>Comparable</code></a>)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_définir_un_ordre_naturel_sur_des_personnes"><a class="anchor" href="#_définir_un_ordre_naturel_sur_des_personnes"></a>3.2.23. Définir un ordre naturel sur des personnes</h4>
<div class="listingblock">
<div class="title">Déclaration de la classe</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">class Person implements Comparable&lt;Person&gt; {</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Redéfinition de la comparaison selon l&#8217;ordre naturel</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">    /**
     * Compare deux personnes.
     * La comparaison se fait d'abord selon l'ordre
     * lexicographique du nom puis selon le prénom.
     *
     * @param p une personne
     * @return la valeur de comparaison entre les chaînes représentant les noms
     * ou entre les prénoms si les noms sont égaux.
     */
    @Override
    public int compareTo(Person p) {
        int cmpNom = nom.compareTo(p.nom);
        return (cmpNom != 0 ? cmpNom : prenom.compareTo(p.prenom));
    }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ordonner_des_objets_selon_un_ordre_spécifique"><a class="anchor" href="#_ordonner_des_objets_selon_un_ordre_spécifique"></a>3.2.24. Ordonner des objets selon un ordre spécifique</h4>
<div class="ulist">
<div class="title">Le problème</div>
<ul>
<li>
<p>Comment ordonner des objets selon un ordre particulier (différent de l&#8217;ordre naturel) ?</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">En Java</div>
<ul>
<li>
<p>La solution proposée est de fournir un <em>comparateur</em>, i.e. une instance d&#8217;une classe implémentant l&#8217;interface <code>Comparator</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_l_interface_code_comparator_code"><a class="anchor" href="#_l_interface_code_comparator_code"></a>3.2.25. L&#8217;interface <code>Comparator</code></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">public interface Comparator&lt;T&gt; {
  int compare(T o1, T o2);
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>compare</code> doit retourner un entier négatif (respectivement zéro, un entier positif) si le premier paramètre est inférieur (respectivement égal, supérieur) au second</p>
</li>
<li>
<p>Si l&#8217;argument n&#8217;est pas du bon type, <code>compare</code> doit lancer l&#8217;exception <code>ClassCastException</code></p>
</li>
<li>
<p>L&#8217;ordre ainsi défini doit induire un <em>ordre partiel</em> (cf. la documentation de <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Comparator.html"><code>Comparator</code></a>)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_définir_un_ordre_spécifique_sur_des_personnes"><a class="anchor" href="#_définir_un_ordre_spécifique_sur_des_personnes"></a>3.2.26. Définir un ordre spécifique sur des personnes</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">package fr.uvsq.info.poo.collections;

import java.util.Comparator;

/**
 * Permet de comparer des personnes selon leur âge.
 *
 * @author Stéphane Lopes
 * @version fév. 2017
 */
class ByAgeComparator implements Comparator&lt;Person&gt; {
    /**
     * Compare deux personnes selon leur âge.
     *
     * @return l'écart d'age entre les deux personnes.
     */
    public int compare(Person p1, Person p2) {
        return p1.getAge() - p2.getAge();
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_trier_une_liste_de_personnes"><a class="anchor" href="#_trier_une_liste_de_personnes"></a>3.2.27. Trier une liste de personnes</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">        List&lt;Person&gt; lst = Arrays.asList(
                new Person("Ariane", "Dupond", 9),
                new Person("Cassiopée", "Dupond", 8),
                new Person("Hélios", "Martin", 4)
        );

        Collections.sort(lst); // tri selon l'ordre naturel
        System.out.println(lst);

        Collections.sort(lst, new ByAgeComparator()); // peut être remplacé par
        lst.sort((p1, p2) -&gt; p1.getAge() - p2.getAge()); // peut être remplacé par
        lst.sort(Comparator.comparing(Person::getAge)); // tri selon l'âge
        System.out.println(lst);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_l_interface_code_sortedset_code_1_2"><a class="anchor" href="#_l_interface_code_sortedset_code_1_2"></a>3.2.28. L&#8217;interface <code>SortedSet</code> 1/2</h4>
<div class="ulist">
<ul>
<li>
<p>Cette interface permet de maintenir les éléments d&#8217;une ensemble en ordre croissant selon l&#8217;ordre naturel ou un ordre spécifié par un comparateur</p>
</li>
<li>
<p>Elle fournit des méthodes pour:</p>
<div class="ulist">
<ul>
<li>
<p>manipuler un interval d&#8217;éléments</p>
</li>
<li>
<p>accéder au plus petit ou au plus grand élément</p>
</li>
<li>
<p>récupérer le comparateur utilisé (s&#8217;il existe)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Les opérations héritées de <code>Set</code> fonctionnent à l&#8217;identique mais :</p>
<div class="ulist">
<ul>
<li>
<p>l&#8217;itérateur respecte l&#8217;ordre</p>
</li>
<li>
<p><code>toArray</code> conserve l&#8217;ordre</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_l_interface_code_sortedset_code_2_2"><a class="anchor" href="#_l_interface_code_sortedset_code_2_2"></a>3.2.29. L&#8217;interface <code>SortedSet</code> 2/2</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">public interface SortedSet&lt;E&gt; extends Set&lt;E&gt; {
  // Vue par intervalle
  SortedSet&lt;E&gt; subSet(E fromElement, E toElement);
  SortedSet&lt;E&gt; headSet(E toElement);
  SortedSet&lt;E&gt; tailSet(E fromElement);

  // Extrémités
  E first();
  E last();

  // Comparateur
  Comparator&lt;? super E&gt; comparator();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_l_interface_code_sortedmap_code_1_2"><a class="anchor" href="#_l_interface_code_sortedmap_code_1_2"></a>3.2.30. L&#8217;interface <code>SortedMap</code> 1/2</h4>
<div class="ulist">
<ul>
<li>
<p>Cette interface permet de maintenir une <code>Map</code> ordonnée selon l&#8217;odre naturel de ses clés ou selon un comparateur</p>
</li>
<li>
<p>Elle fournit des méthodes pour:</p>
<div class="ulist">
<ul>
<li>
<p>manipuler un interval d&#8217;éléments</p>
</li>
<li>
<p>accéder au plus petit ou au plus grand élément</p>
</li>
<li>
<p>récupérer le comparateur utilisé (s&#8217;il existe)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_l_interface_code_sortedmap_code_2_2"><a class="anchor" href="#_l_interface_code_sortedmap_code_2_2"></a>3.2.31. L&#8217;interface <code>SortedMap</code> 2/2</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">public interface SortedMap&lt;K, V&gt; extends Map&lt;K, V&gt; {
  // Range-view
  SortedMap&lt;K, V&gt; subMap(K fromKey, K toKey);
  SortedMap&lt;K, V&gt; headMap(K toKey);
  SortedMap&lt;K, V&gt; tailMap(K fromKey);

  // Endpoints
  K firstKey();
  K lastKey();

  // Comparator access
  Comparator&lt;? super K&gt; comparator();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_implémentations"><a class="anchor" href="#_implémentations"></a>3.3. Implémentations</h3>
<div class="sect3">
<h4 id="_les_implémentations"><a class="anchor" href="#_les_implémentations"></a>3.3.1. Les implémentations</h4>
<div class="ulist">
<ul>
<li>
<p>Les implémentations sont les structures de données proprement dites</p>
</li>
<li>
<p>On en trouve plusieurs sortes en Java</p>
<div class="ulist">
<ul>
<li>
<p>les <em>implémentations généralistes</em> sont les plus couramment utilisées</p>
</li>
<li>
<p>les <em>implémentations spécialisées</em> sont conçues pour un cas particulier</p>
</li>
<li>
<p>les <em>implémentations supportant la concurrence</em> pour les applications multi-threads</p>
</li>
<li>
<p>les <em>implémentations "décorations"</em> permettent de modifier les caractéristiques d&#8217;une autre implémentation</p>
</li>
<li>
<p>les <em>implémentations "simples"</em> sont des implémentations minimalistes optimisées pour un cas particulier (singleton par exemple)</p>
</li>
<li>
<p>les <em>implémentations abstraites</em> servent de base pour le développement d&#8217;implémentation personnalisée</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_implémentations_généralistes"><a class="anchor" href="#_implémentations_généralistes"></a>3.3.2. Implémentations généralistes</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.667%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interface</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hashage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tableau dyn.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Arbre équ.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Liste chaînée</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hash. + chaîn.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Set</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong>HashSet</strong></code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TreeSet</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LinkedHashSet</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong>ArrayList</strong></code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LinkedList</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Queue</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong>ArrayDeque</strong></code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LinkedList</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DeQueue</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong>ArrayDeque</strong></code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LinkedList</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Map</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong>HashMap</strong></code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TreeMap</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LinkedHashMap</code></p></td>
</tr>
</tbody>
</table>
<div class="ulist">
<ul>
<li>
<p>Les implémentations principales sont en gras</p>
</li>
<li>
<p><code>TreeSet</code> (respectivement <code>TreeMap</code>) implémente également <code>SortedSet</code> (respectivement <code>SortedMap</code>)</p>
</li>
<li>
<p><code>Queue</code> possède aussi pour implémentation <code>PriorityQueue</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_caractéristiques_des_implémentations_généralistes"><a class="anchor" href="#_caractéristiques_des_implémentations_généralistes"></a>3.3.3. Caractéristiques des implémentations généralistes</h4>
<div class="ulist">
<ul>
<li>
<p>Toutes les implémentations implémentent toutes les méthodes optionnelles</p>
</li>
<li>
<p>Toutes sont sérialisables</p>
</li>
<li>
<p>Toutes supportent l&#8217;opération <code>clone</code></p>
</li>
<li>
<p>Elles ne sont pas synchronisées (pour des raisons de performance)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_utilisation_des_implémentations_généralistes"><a class="anchor" href="#_utilisation_des_implémentations_généralistes"></a>3.3.4. Utilisation des implémentations généralistes</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Choisir un type d&#8217;implémentation</p>
</li>
<li>
<p>Créer une instance de cette implémentation</p>
</li>
<li>
<p>La lier à une référence sur l&#8217;interface correspondante</p>
<div class="ulist">
<ul>
<li>
<p>le programme reste alors indépendant du choix de l&#8217;implémentation</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">Set&lt;Integer&gt; unEnsemble = new HashSet&lt;&gt;();
List&lt;Integer&gt; uneList = new ArrayList&lt;&gt;();
Map&lt;String, String&gt; uneMap = new HashMap&lt;&gt;();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_les_implémentations_généralistes_de_code_set_code"><a class="anchor" href="#_les_implémentations_généralistes_de_code_set_code"></a>3.3.5. Les implémentations généralistes de <code>Set</code></h4>
<div class="ulist">
<ul>
<li>
<p><code>HashSet</code> est plus rapide mais ne garantit pas l&#8217;ordre</p>
<div class="ulist">
<ul>
<li>
<p>la plupart des opérations sont en temps constant</p>
</li>
<li>
<p>la <em>capacité</em> et le <em>facteur de charge</em> permettent d&#8217;affiner les performances de <code>HashSet</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>TreeSet</code> maintient l&#8217;ordre des éléments</p>
<div class="ulist">
<ul>
<li>
<p>la plupart des opérations sont en temps logarithmique</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
on choisit <code>HashSet</code> sauf si on a besoin d&#8217;un ordre sur les éléments
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_les_implémentations_généralistes_de_code_map_code"><a class="anchor" href="#_les_implémentations_généralistes_de_code_map_code"></a>3.3.6. Les implémentations généralistes de <code>Map</code></h4>
<div class="ulist">
<ul>
<li>
<p>Situation analogue à <code>Set</code></p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
on choisit <code>HashMap</code> sauf si on a besoin d&#8217;un ordre sur les éléments
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_les_implémentations_de_code_list_code"><a class="anchor" href="#_les_implémentations_de_code_list_code"></a>3.3.7. Les implémentations de <code>List</code></h4>
<div class="ulist">
<ul>
<li>
<p><code>ArrayList</code> est plus rapide</p>
<div class="ulist">
<ul>
<li>
<p>permet un accès par position en temps constant</p>
</li>
<li>
<p>pas d&#8217;allocation à chaque ajout</p>
</li>
<li>
<p>on peut passer une <em>capacité</em> au constructeur de <code>ArrayList</code></p>
</li>
<li>
<p>possède les opérations <code>ensureCapacity</code> et <code>trimToSize</code> en plus de celle de l&#8217;interface <code>List</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>LinkedList</code> est linéaire pour l&#8217;accès par position</p>
<div class="ulist">
<ul>
<li>
<p>adaptée si on fait beaucoup d&#8217;insertions/suppressions en milieu de liste (opérations en temps constant mais le facteur constant est élevé)</p>
</li>
<li>
<p>possède les opérations <code>addFirst</code>, <code>getFirst</code>, <code>removeFirst</code>, <code>addLast</code>, <code>getLast</code>, et <code>removeLast</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
on choisit <code>ArrayList</code> sauf si on a beaucoup de modifications en milieu de liste
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_quelques_implémentations_spécialisées"><a class="anchor" href="#_quelques_implémentations_spécialisées"></a>3.3.8. Quelques implémentations spécialisées</h4>
<div class="ulist">
<ul>
<li>
<p><code>EnumSet</code> (<code>Set</code>) est une implémentation efficace (vecteur de bits) pour les énumérations</p>
</li>
<li>
<p><code>CopyOnWriteArraySet</code> (<code>Set</code>) effectue une copie de l&#8217;ensemble pour chaque modification</p>
</li>
<li>
<p><code>CopyOnWriteArrayList</code> (<code>List</code>) effectue une copie de la liste pour chaque modification</p>
</li>
<li>
<p><code>EnumMap</code> (<code>Map</code>) permet d&#8217;associer une instance d&#8217;énumération à une valeur</p>
</li>
<li>
<p><code>WeakHashMap</code> (<code>Map</code>) autorise la libération de la mémoire d&#8217;une paire (clé, valeur) dès que la clé n&#8217;est plus référencée</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_implémentations_décorations"><a class="anchor" href="#_implémentations_décorations"></a>3.3.9. Implémentations "décorations"</h4>
<div class="ulist">
<ul>
<li>
<p>Une telle implémentation délégue les traitements principaux à une collection particulière mais y ajoute un certain nombre de fonctionnalités</p>
<div class="ulist">
<ul>
<li>
<p>modèle de conception <em>Décorateur</em></p>
</li>
</ul>
</div>
</li>
<li>
<p>Ces implémentations sont <em>anonymes</em></p>
<div class="ulist">
<ul>
<li>
<p>pas de classe publique mais une méthode de fabrication statique</p>
</li>
<li>
<p>on les obtient par des méthodes de classe (<em>static factory method</em>) de la classe <code>Collections</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Plusieurs catégories sont disponibles :</p>
<div class="ulist">
<ul>
<li>
<p>avec synchronisation pour rendre les collections "tolérantes aux threads"</p>
</li>
<li>
<p>non modifiables pour supprimer toute possibilité de modification d&#8217;une collection</p>
</li>
<li>
<p>vérifiant le type dynamiquement</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">List&lt;Integer&gt; list = Collections.synchronizedList(new ArrayList&lt;Integer&gt;());
Collection&lt;String&gt; collec = Collections.unmodifiableCollection(uneCollection);
Set&lt;String&gt; set = Collections.checkedSet(new HashSet&lt;String&gt;(), String.class);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_les_implémentations_simples"><a class="anchor" href="#_les_implémentations_simples"></a>3.3.10. Les implémentations "simples"</h4>
<div class="ulist">
<ul>
<li>
<p>Ces implémentations sont des "mini" implémentations plus pratiques et généralement plus performantes que les implémentations généralistes</p>
<div class="ulist">
<ul>
<li>
<p><code>Arrays.asList</code> permet de manipuler un tableau comme une liste</p>
</li>
<li>
<p><code>Collections.nCopies</code> génère une liste non modifiable contenant de multiples copies du même élément</p>
</li>
<li>
<p><code>Collections.singleton</code> génère un ensemble non modifiable contenant un unique élément</p>
</li>
<li>
<p><code>emptySet</code>, <code>emptyList</code> et <code>emptyMap</code> de la classe <code>Collections</code> représentent l&#8217;ensemble, la liste et le tableau associatif vides</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_utiliser_des_implémentations_simples"><a class="anchor" href="#_utiliser_des_implémentations_simples"></a>3.3.11. Utiliser des implémentations "simples"</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">// Créer une liste de taille fixe
List&lt;String&gt; list = Arrays.asList(new String[size]);

// Créer une liste de 1000 éléments initialisés à null
List&lt;Type&gt; l = new ArrayList&lt;&gt;(Collections.nCopies(1000, (Type)null));

// Ajouter 10 fois la chaîne "element" à une collection
uneCollection.addAll(Collections.nCopies(10, "element"));

// Supprimer toutes les occurences de e dans la collection
c.removeAll(Collections.singleton(e));

// Supprimer tous les juristes d'une map
profession.values().removeAll(Collections.singleton(JURISTE));

// Récupérer une liste vide
List&lt;String&gt; s = Collections.emptyList();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_Écrire_une_implémentation"><a class="anchor" href="#_Écrire_une_implémentation"></a>3.3.12. Écrire une implémentation</h4>
<div class="ulist">
<ul>
<li>
<p>La notion d'<em>implémentation abstraite</em> simplifie l&#8217;écriture d&#8217;une implémentation</p>
</li>
<li>
<p>Une <em>implémentation abstraite</em> est un squelette d&#8217;implémentation d&#8217;une collection</p>
</li>
<li>
<p>Processus pour écrire son implémentation</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>choisir une implémentation abstraite appropriée</p>
</li>
<li>
<p>implémenter les méthodes abstraites (et éventuellement certaines méthodes concrêtes)</p>
</li>
<li>
<p>tester l&#8217;implémentation obtenue</p>
</li>
<li>
<p>si les performances sont importantes, étudier les caractéristiques des méthodes héritées et les redéfinir si nécessaire</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_principales_implémentations_abstraites"><a class="anchor" href="#_principales_implémentations_abstraites"></a>3.3.13. Principales implémentations abstraites</h4>
<div class="ulist">
<ul>
<li>
<p><code>AbstractCollection</code> pour une collection quelconque</p>
<div class="ulist">
<ul>
<li>
<p>les méthodes <code>iterator</code> et <code>size</code> doivent être fournies</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>AbstractSet</code> pour un ensemble (même utilisation que <code>AbstractCollection</code>)</p>
</li>
<li>
<p><code>AbstractList</code> pour une liste basée sur une structure à accès aléatoire (comme un tableau)</p>
<div class="ulist">
<ul>
<li>
<p>les méthodes <code>get(int)</code> et <code>size</code> doivent être fournies</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>AbstractSequentialList</code> pour une liste basée sur une structure à accès séquentiel (comme une liste chaînée)</p>
<div class="ulist">
<ul>
<li>
<p>les méthodes <code>listIterator</code> et <code>size</code> doivent être fournies</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>AbstractQueue</code> nécessite de fournir les méthodes <code>offer</code>, <code>peek</code>, <code>poll</code> et <code>size</code> ainsi qu&#8217;un itérateur supportant <code>remove</code></p>
</li>
<li>
<p><code>AbstractMap</code> pour un tableau associatif</p>
<div class="ulist">
<ul>
<li>
<p>la vue <code>entrySet</code> doit être fournie</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_algorithmes"><a class="anchor" href="#_algorithmes"></a>3.4. Algorithmes</h3>
<div class="sect3">
<h4 id="_les_algorithmes"><a class="anchor" href="#_les_algorithmes"></a>3.4.1. Les algorithmes</h4>
<div class="ulist">
<ul>
<li>
<p>Les algorithmes sont des méthodes de classe de la classe <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Collections.html"><code>Collections</code></a></p>
</li>
<li>
<p>Le premier paramètre de ces algorithmes est la collection traitée</p>
</li>
<li>
<p>La plupart opèrent sur des listes</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_quelques_algorithmes_disponibles"><a class="anchor" href="#_quelques_algorithmes_disponibles"></a>3.4.2. Quelques algorithmes disponibles</h4>
<div class="ulist">
<ul>
<li>
<p>tri : <code>sort</code> (complexité en \$n log(n)\$, stable)</p>
</li>
<li>
<p>mélange : <code>shuffle</code></p>
</li>
<li>
<p>manipulation des données : <code>reverse</code>, <code>fill</code>, <code>copy</code>, <code>swap</code>, <code>addAll</code></p>
</li>
<li>
<p>recherche dans une collection triée : <code>binarySearch</code></p>
</li>
<li>
<p>composition : <code>frequency</code>, <code>disjoint</code></p>
</li>
<li>
<p>extremum : <code>min</code>, <code>max</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">List&lt;Integer&gt; l = new ArrayList&lt;Integer&gt;();
// ...
Collections.sort(l);
int pos = Collections.binarySearch(l, key);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mise_en_uvre"><a class="anchor" href="#_mise_en_uvre"></a>3.5. Mise en &oelig;uvre</h3>
<div class="sect3">
<h4 id="_exercice_sur_les_listes"><a class="anchor" href="#_exercice_sur_les_listes"></a>3.5.1. Exercice sur les listes</h4>
<div class="ulist">
<ul>
<li>
<p>Créer une liste (basée sur <code>ArrayList</code>) contenant les 10 premiers entiers</p>
</li>
<li>
<p>Mélanger aléatoirement les éléments</p>
<div class="ulist">
<ul>
<li>
<p>utiliser la méthode de classe <code>void shuffle(List&lt;?&gt; list)</code> de la classe <code>Collections</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Afficher la liste à l&#8217;endroit puis à l&#8217;envers</p>
</li>
<li>
<p>Trier la liste selon l&#8217;ordre naturel (croissant) puis selon l&#8217;ordre inverse (décroissant)</p>
<div class="ulist">
<ul>
<li>
<p>utiliser les méthodes de classe <code>void sort(List&lt;?&gt; list)</code> et <code>void sort(List&lt;?&gt; list, Comparator&lt;? super T&gt; c)</code> de la classe <code>Collections</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Que doit-on changer pour utiliser une <code>LinkedList</code> à la place d&#8217;une <code>ArrayList</code> ?</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_créer_une_liste_contenant_les_10_premiers_entiers"><a class="anchor" href="#_créer_une_liste_contenant_les_10_premiers_entiers"></a>3.5.2. Créer une liste contenant les 10 premiers entiers</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">        List&lt;Integer&gt; uneListe = new ArrayList&lt;&gt;();
        for (int i = 0; i &lt; MAX; ++i) uneListe.add(i);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_mélanger_aléatoirement_les_éléments"><a class="anchor" href="#_mélanger_aléatoirement_les_éléments"></a>3.5.3. Mélanger aléatoirement les éléments</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">        Collections.shuffle(uneListe);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_afficher_la_liste_à_l_endroit_puis_à_l_envers"><a class="anchor" href="#_afficher_la_liste_à_l_endroit_puis_à_l_envers"></a>3.5.4. Afficher la liste à l&#8217;endroit puis à l&#8217;envers</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">        System.out.println(uneListe);
        for (ListIterator&lt;Integer&gt; it = uneListe.listIterator(uneListe.size());
             it.hasPrevious(); ) {
            System.out.print(it.previous());
            System.out.print(", ");
        }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_trier_la_liste_selon_l_ordre_naturel_croissant_puis_selon_l_ordre_inverse_décroissant"><a class="anchor" href="#_trier_la_liste_selon_l_ordre_naturel_croissant_puis_selon_l_ordre_inverse_décroissant"></a>3.5.5. Trier la liste selon l&#8217;ordre naturel (croissant) puis selon l&#8217;ordre inverse (décroissant)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">        Collections.sort(uneListe);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">        uneListe.sort((i1, i2) -&gt; i2 - i1);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">        uneListe.sort(Collections.reverseOrder());</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_que_doit_on_changer_pour_utiliser_une_code_linkedlist_code_à_la_place_d_une_code_arraylist_code"><a class="anchor" href="#_que_doit_on_changer_pour_utiliser_une_code_linkedlist_code_à_la_place_d_une_code_arraylist_code"></a>3.5.6. Que doit-on changer pour utiliser une <code>LinkedList</code> à la place d&#8217;une <code>ArrayList</code> ?</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">        // Remplacer
        List&lt;Integer&gt; uneListe = new ArrayList&lt;&gt;();
        // Par
        List&lt;Integer&gt; uneListe = new LinkedList&lt;&gt;();
        //
        // Le reste du programme ne change pas !
        //</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_exercice_sur_les_tableaux_associatifs"><a class="anchor" href="#_exercice_sur_les_tableaux_associatifs"></a>3.5.7. Exercice sur les tableaux associatifs</h4>
<div class="ulist">
<ul>
<li>
<p>Créer un tableau associatif (<code>HashMap</code>) contenant les 10 premiers entiers associés à leur cube</p>
</li>
<li>
<p>Afficher les valeurs des cubes triées par ordre croissant</p>
</li>
<li>
<p>Afficher les nombres pairs et leur cube</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_créer_un_tableau_associatif_contenant_les_10_premiers_entiers_associés_à_leur_cube"><a class="anchor" href="#_créer_un_tableau_associatif_contenant_les_10_premiers_entiers_associés_à_leur_cube"></a>3.5.8. Créer un tableau associatif contenant les 10 premiers entiers associés à leur cube</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">        Map&lt;Integer, Integer&gt; uneMap = new HashMap&lt;&gt;();
        for (int i = 0; i &lt; MAX; ++i) uneMap.put(i, i * i * i);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_afficher_les_valeurs_des_cubes_triées_par_ordre_croissant"><a class="anchor" href="#_afficher_les_valeurs_des_cubes_triées_par_ordre_croissant"></a>3.5.9. Afficher les valeurs des cubes triées par ordre croissant</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">        List&lt;Integer&gt; lesCubes = new ArrayList&lt;&gt;(uneMap.values());
        Collections.sort(lesCubes);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_afficher_les_nombres_pairs_et_leur_cube"><a class="anchor" href="#_afficher_les_nombres_pairs_et_leur_cube"></a>3.5.10. Afficher les nombres pairs et leur cube</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">        for (Map.Entry&lt;Integer, Integer&gt; elt : uneMap.entrySet()) {
            if (elt.getKey() % 2 == 0) {
                System.out.println(elt.getKey() + " -&gt; " + elt.getValue());
            }
        }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exercices_3"><a class="anchor" href="#_exercices_3"></a>3.6. Exercices</h3>
<div class="sect3">
<h4 id="_utilisation_des_collections"><a class="anchor" href="#_utilisation_des_collections"></a>3.6.1. Utilisation des collections</h4>
<div class="paragraph">
<p>L&#8217;objet de cet exercice est de simuler l&#8217;interrogation d&#8217;un DNS (<em>Domain Name Server</em>).
Un DNS convertit une adresse IP (<code>192.168.0.1</code> par exemple) en un nom qualifié de machine (<code>machine.domaine.local</code> par exemple) et inversement.
Un nom qualifié comporte le nom de la machine (avant le premier <code>'.'</code>) et un nom de domaine (après le premier <code>'.'</code>).</p>
</div>
<div class="paragraph">
<p>L&#8217;interface proposera une ligne de commande à partir de laquelle les commandes suivantes devront être interprétées:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>nom.qualifié.machine</code> : l&#8217;adresse IP de la machine est affichée;</p>
</li>
<li>
<p><code>adr.es.se.ip</code> : le nom qualifié de cette machine est affiché;</p>
</li>
<li>
<p><code>ls [-a]</code> <em>domaine</em> : la liste des machines du domaine <em>domaine</em> sera affichée triée selon le nom des machines ou selon les adresses IP (si <code>-a</code> est présent).</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>La base de données du serveur sera conservée dans un fichier texte (une ligne par machine au format &#8220;un_nom_de_machine une.adresse.IP&#8221;) chargé au lancement du programme.</p>
</li>
<li>
<p>Le nom du fichier devra être stocké dans un fichier de propriétés (cf. <a href="http://docs.oracle.com/javase/tutorial/essential/environment/properties.html">Tutoriel sur les propriétés</a>).</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Réaliser les classes <code>AdresseIP</code>, <code>NomMachine</code> et <code>DnsItem</code> qui représentent respectivement une adresse IP, un nom qualifié de machine et une entrée du DNS.</p>
</li>
<li>
<p>Réaliser la classe <code>Dns</code> qui proposera les opérations suivantes:</p>
<div class="ulist">
<ul>
<li>
<p>un constructeur qui chargera la base de données,</p>
</li>
<li>
<p>deux méthodes <code>getItem</code> qui retourneront une instance de <code>DnsItem</code> soit à partir d&#8217;une adresse IP, soit à partir d&#8217;un nom de machine,</p>
</li>
<li>
<p>une méthode <code>getItems</code> qui retournera une liste d&#8217;items à partir d&#8217;un nom de domaine.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Réaliser la classe <code>DnsTUI</code> qui se chargera des interactions avec l&#8217;utilisateur.
Cette classe fournira une méthode <code>nextCommande</code> qui analysera le texte saisi par l&#8217;utilisateur et retournera un objet implémentant l&#8217;interface <code>Commande</code> (cf. question suivante) et une méthode <code>affiche</code> qui affichera un résultat.</p>
</li>
<li>
<p>Les commandes DNS seront implémentées à l&#8217;aide du modèle de conception <a href="http://en.wikipedia.org/wiki/Command_pattern">Commande</a>.</p>
<div class="ulist">
<ul>
<li>
<p>créer l&#8217;interface <code>Commande</code> comportant une seule méthode <code>execute</code>,</p>
</li>
<li>
<p>créer une classe implémentant cette interface pour chaque action (rechercher une IP, rechercher un nom, rechercher les machines d&#8217;un domaine, quitter l&#8217;application).</p>
</li>
</ul>
</div>
</li>
<li>
<p>Réaliser la classe principale <code>DnsApp</code>.
La méthode <code>run</code> de cette classe interagira avec l&#8217;interface utilisateur pour récupérer la prochaine commande, l&#8217;exécutera puis affichera la résultat.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_Écriture_d_algorithmes"><a class="anchor" href="#_Écriture_d_algorithmes"></a>3.6.2. Écriture d&#8217;algorithmes</h4>
<div class="paragraph">
<p>Le but de cet exercice est d&#8217;écrire des algorithmes pouvant s&#8217;appliquer à toute collection respectant l&#8217;interface <code>List</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ecrire un algorithme <code>bubbleSort</code> implémentant le tri à bulle.
Deux versions de l&#8217;algorithme seront proposées:
la première basée sur l&#8217;interface <code>Comparable</code>, la deuxième sur l&#8217;interface <code>Comparator</code> pour les comparaisons.</p>
</li>
<li>
<p>Ecrire un algorithme <code>copyIf</code> créant une copie d&#8217;une collection contenant uniquement les éléments vérifiant une condition passée en paramètre</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_exercice_de_synthèse"><a class="anchor" href="#_exercice_de_synthèse"></a>3.6.3. Exercice de synthèse</h4>
<div class="paragraph">
<p>Le but de cet exercice est de réaliser un logiciel de dessin 2D.
On se limitera ici à un affichage textuel, i.e. seule une description des figures sera affichée.</p>
</div>
<div class="paragraph">
<p>Le logiciel devra offrir les fonctionnalités suivantes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>manipulation (affichage et déplacement) des formes comme des rectangles et des cercles,</p>
</li>
<li>
<p>regroupement d&#8217;objets afin de leur faire subir un traitement global
(par exemple, déplacer ensemble un cercle et un rectangle),</p>
</li>
<li>
<p>sauvegarde/chargement d&#8217;un dessin à l&#8217;aide de la sérialisation.</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>Les erreurs devront être gérées en utilisant les exceptions,</p>
</li>
<li>
<p>les ensembles de formes avec la librairie de collections.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Proposer une hiérarchie de classe modélisant ce problème et un découpage en module du logiciel</p>
</li>
<li>
<p>Réaliser une implémentation du logiciel de dessin</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 2016-2017<br>
Last updated 2017-03-21 14:29:20 CET
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/highlight.min.js"></script>
<script>hljs.initHighlighting()</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.0/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>